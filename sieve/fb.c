/*****************************************************************
 *                Functions for the factor base                  *
 *****************************************************************/

#include "cado.h"
#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include <string.h>
#include <math.h>
#include <ctype.h>
#define rdtscll(x)
#include "basicnt.h"
#include "fb.h"
#include "utils.h"

/* sorted list of prime powers < 2^32, with 6947 entries, and two sentinel
 entries 0 and 2^32-1 */
static uint32_t prime_powers[] = {
  0, 4, 8, 9, 16, 25, 27, 32, 49, 64, 81, 121, 125, 128, 169, 243, 256, 289, 343, 361, 512, 529, 625, 729, 841, 961, 1024, 1331, 1369, 1681, 1849, 2048, 2187, 2197, 2209, 2401, 2809, 3125, 3481, 3721, 4096, 4489, 4913, 5041, 5329, 6241, 6561, 6859, 6889, 7921, 8192, 9409, 10201, 10609, 11449, 11881, 12167, 12769, 14641, 15625, 16129, 16384, 16807, 17161, 18769, 19321, 19683, 22201, 22801, 24389, 24649, 26569, 27889, 28561, 29791, 29929, 32041, 32761, 32768, 36481, 37249, 38809, 39601, 44521, 49729, 50653, 51529, 52441, 54289, 57121, 58081, 59049, 63001, 65536, 66049, 68921, 69169, 72361, 73441, 76729, 78125, 78961, 79507, 80089, 83521, 85849, 94249, 96721, 97969, 100489, 103823, 109561, 113569, 117649, 120409, 121801, 124609, 128881, 130321, 131072, 134689, 139129, 143641, 146689, 148877, 151321, 157609, 160801, 161051, 167281, 175561, 177147, 177241, 185761, 187489, 192721, 196249, 201601, 205379, 208849, 212521, 214369, 218089, 226981, 229441, 237169, 241081, 249001, 253009, 259081, 262144, 271441, 273529, 279841, 292681, 299209, 300763, 310249, 316969, 323761, 326041, 332929, 344569, 351649, 357911, 358801, 361201, 368449, 371293, 375769, 380689, 383161, 389017, 390625, 398161, 410881, 413449, 418609, 426409, 434281, 436921, 452929, 458329, 466489, 477481, 491401, 493039, 502681, 516961, 524288, 528529, 531441, 537289, 546121, 552049, 564001, 571787, 573049, 579121, 591361, 597529, 619369, 635209, 654481, 657721, 674041, 677329, 683929, 687241, 703921, 704969, 707281, 727609, 734449, 737881, 744769, 769129, 776161, 779689, 786769, 822649, 823543, 829921, 844561, 863041, 877969, 885481, 896809, 908209, 912673, 923521, 935089, 942841, 954529, 966289, 982081, 994009, 1018081, 1026169, 1030301, 1038361, 1042441, 1048576, 1062961, 1067089, 1079521, 1092727, 1100401, 1104601, 1125721, 1129969, 1142761, 1181569, 1190281, 1194649, 1203409, 1216609, 1225043, 1229881, 1247689, 1261129, 1274641, 1295029, 1324801, 1329409, 1352569, 1371241, 1394761, 1408969, 1419857, 1423249, 1442401, 1442897, 1471369, 1481089, 1495729, 1510441, 1515361, 1530169, 1560001, 1585081, 1594323, 1630729, 1635841, 1646089, 1661521, 1666681, 1682209, 1692601, 1697809, 1708249, 1739761, 1745041, 1760929, 1771561, 1852321, 1868689, 1874161, 1885129, 1907161, 1953125, 1957201, 1985281, 2024929, 2036329, 2042041, 2048383, 2053489, 2070721, 2093809, 2097152, 2105401, 2111209, 2128681, 2163841, 2193361, 2199289, 2211169, 2217121, 2229049, 2247001, 2248091, 2283121, 2319529, 2343961, 2380849, 2399401, 2411809, 2430481, 2455489, 2468041, 2476099, 2493241, 2505889, 2550409, 2563201, 2571353, 2582449, 2588881, 2601769, 2621161, 2627641, 2647129, 2679769, 2685619, 2745649, 2765569, 2778889, 2785561, 2825761, 2866249, 2879809, 2886601, 2920681, 2961841, 2968729, 3003289, 3031081, 3052009, 3073009, 3094081, 3157729, 3179089, 3193369, 3200521, 3243601, 3279721, 3307949, 3323329, 3352561, 3411409, 3418801, 3442951, 3463321, 3485689, 3500641, 3508129, 3523129, 3530641, 3568321, 3613801, 3636649, 3659569, 3728761, 3736489, 3798601, 3806401, 3869893, 3892729, 3916441, 3948169, 3972049, 3988009, 3996001, 4012009, 4044121, 4068289, 4108729, 4116841, 4157521, 4194304, 4214809, 4255969, 4280761, 4330561, 4330747, 4338889, 4355569, 4363921, 4405801, 4456321, 4464769, 4532641, 4541161, 4566769, 4583881, 4592449, 4635409, 4657463, 4669921, 4748041, 4782969, 4826809, 4853209, 4870849, 4879681, 4897369, 4932841, 5004169, 5013121, 5031049, 5067001, 5139289, 5148361, 5166529, 5177717, 5202961, 5230369, 5257849, 5276209, 5331481, 5340721, 5442889, 5470921, 5480281, 5508409, 5527201, 5555449, 5621641, 5650129, 5669161, 5678689, 5707321, 5726449, 5735339, 5755201, 5764801, 5812921, 5841889, 5870929, 5929741, 5938969, 5958481, 5987809, 6046681, 6086089, 6115729, 6135529, 6265009, 6355441, 6405961, 6436343, 6446521, 6466849, 6497401, 6507601, 6538249, 6651241, 6713281, 6723649, 6806881, 6848689, 6869641, 6932689, 6967871, 7006609, 7059649, 7070281, 7091569, 7134241, 7166329, 7189057, 7198489, 7219969, 7230721, 7252249, 7284601, 7327849, 7349521, 7360369, 7392961, 7447441, 7458361, 7513081, 7557001, 7579009, 7645373, 7656289, 7711729, 7778521, 7789681, 7823209, 7845601, 7856809, 7880599, 7890481, 7946761, 8025889, 8048569, 8082649, 8128201, 8162449, 8185321, 8288641, 8334769, 8388608, 8392609, 8427409, 8462281, 8508889, 8567329, 8637721, 8720209, 8743849, 8779369, 8814961, 8826841, 8994001, 9006001, 9066121, 9114361, 9138529, 9223369, 9247681, 9296401, 9369721, 9393931, 9406489, 9480241, 9504889, 9541921, 9665881, 9728161, 9740641, 9765625, 9840769, 10004569, 10029889, 10042561, 10118761, 10156969, 10182481, 10259209, 10297681, 10349089, 10374841, 10426441, 10569001, 10582009, 10608049, 10621081, 10699441, 10883401, 10896601, 10936249, 10975969, 11015761, 11042329, 11082241, 11089567, 11095561, 11175649, 11202409, 11282881, 11296321, 11363641, 11377129, 11485321, 11498881, 11607649, 11648569, 11697083, 11785489, 11895601, 11950849, 11978521, 11992369, 12008989, 12020089, 12033961, 12117361, 12187081, 12243001, 12327121, 12369289, 12439729, 12453841, 12482089, 12524521, 12538681, 12581209, 12649337, 12652249, 12666481, 12752041, 12823561, 12837889, 12909649, 13010449, 13053769, 13082689, 13126129, 13184161, 13227769, 13271449, 13388281, 13476241, 13490929, 13520329, 13623481, 13651919, 13667809, 13697401, 13756681, 13830961, 13845841, 13890529, 13935289, 13980121, 13997521, 14145121, 14190289, 14205361, 14280841, 14348907, 14386849, 14417209, 14462809, 14600041, 14615329, 14691889, 14799409, 14830201, 14845609, 14922769, 15031129, 15062161, 15124321, 15264649, 15295921, 15342889, 15358561, 15389929, 15437041, 15452761, 15547249, 15578809, 15737089, 15813251, 15912121, 16008001, 16024009, 16056049, 16104169, 16152361, 16168441, 16216729, 16394401, 16410601, 16459249, 16589329, 16638241, 16736281, 16752649, 16777216, 16801801, 16900321, 16974593, 17032129, 17048641, 17081689, 17131321, 17247409, 17280649, 17297281, 17447329, 17648401, 17732521, 17783089, 17799961, 17884441, 17901361, 17986081, 18003049, 18088009, 18139081, 18156121, 18191447, 18241441, 18258529, 18344089, 18395521, 18464209, 18722929, 18809569, 18826921, 18913801, 18983449, 19035769, 19123129, 19280881, 19333609, 19439281, 19465109, 19487171, 19545241, 19562929, 19722481, 19775809, 19811401, 19864849, 19902511, 19918369, 20079361, 20097289, 20151121, 20187049, 20313049, 20367169, 20403289, 20421361, 20457529, 20511149, 20675209, 20693401, 20802721, 20857489, 21003889, 21077281, 21132409, 21187609, 21253933, 21353641, 21501769, 21520321, 21557449, 21613201, 21631801, 21687649, 21743569, 21836929, 21893041, 22005481, 22118209, 22188041, 22287841, 22306729, 22363441, 22401289, 22572001, 22648081, 22665187, 22877089, 22915369, 22934521, 22972849, 23030401, 23049601, 23164969, 23203489, 23338561, 23629321, 23726641, 23785129, 23902321, 24039409, 24098281, 24137569, 24196561, 24314761, 24334489, 24373969, 24433249, 24512401, 24571849, 24671089, 24690961, 24730729, 24870169, 24930049, 24990001, 25030009, 25090081, 25110121, 25153757, 25210441, 25230529, 25391521, 25411681, 25512601, 25593481, 25775929, 25816561, 25877569, 25999801, 26020201, 26081449, 26142769, 26204161, 26491609, 26553409, 26697889, 26739241, 26822041, 26925721, 27008809, 27133681, 27321529, 27363361, 27384289, 27426169, 27678121, 27804529, 27867841, 27888961, 28058209, 28121809, 28185481, 28334329, 28398241, 28440889, 28590409, 28629151, 28633201, 28934443, 28955161, 29019769, 29084449, 29149201, 29235649, 29300569, 29343889, 29365561, 29495761, 29560969, 29604481, 29626249, 29691601, 29931841, 29997529, 30019441, 30063289, 30080231, 30261001, 30283009, 30327049, 30459361, 30481441, 30547729, 30591961, 30664297, 30880249, 30946969, 31013761, 31058329, 31147561, 31259281, 31618129, 31798321, 31820881, 31855013, 31888609, 31933801, 31956409, 32001649, 32024281, 32137561, 32296489, 32364721, 32410249, 32501401, 32615521, 32684089, 32913169, 32959081, 32982049, 33051001, 33396841, 33443089, 33535681, 33554432, 33651601, 33721249, 33790969, 33884041, 33953929, 34093921, 34140649, 34210801, 34234201, 34304449, 34351321, 34421689, 34445161, 34562641, 34586161, 34774609, 34845409, 35081929, 35129329, 35271721, 35438209, 35772361, 35844169, 36084049, 36132121, 36264691, 36348841, 36445369, 36517849, 36566209, 36638809, 36808489, 36881329, 36954241, 37075921, 37100281, 37222201, 37368769, 37466641, 37589161, 37613689, 37736449, 37834801, 37982569, 38105929, 38272753, 38402809, 38427601, 38477209, 38576521, 38651089, 38700841, 38800441, 38950081, 39025009, 39150049, 39225169, 39300361, 39325441, 39400729, 39526369, 39677401, 39702601, 39828721, 39904489, 39980329, 40056241, 40157569, 40233649, 40353607, 40360609, 40436881, 40462321, 40538689, 40615129, 40691641, 40819321, 40921609, 41229241, 41306329, 41589601, 41615401, 41781923, 41847961, 41899729, 42003361, 42133081, 42508549, 42523441, 42627841, 42863209, 42915601, 42941809, 43046721, 43072969, 43151761, 43178041, 43256929, 43309561, 43546801, 43652449, 43811161, 43986977, 44049769, 44262409, 44342281, 44368921, 44528929, 44609041, 44742721, 44769481, 44903401, 44930209, 45010681, 45144961, 45333289, 45387169, 45711121, 45738169, 45954841, 45981961, 46117681, 46144849, 46268279, 46280809, 46553329, 46607929, 46635241, 46689889, 46799281, 47018449, 47045881, 47100769, 47183161, 47210641, 47375689, 47458321, 47596201, 47706649, 47761921, 47844889, 48260809, 48288601, 48427681, 48455521, 48539089, 48594841, 48678529, 48762289, 48828125, 48874081, 48958009, 49014001, 49182169, 49266361, 49378729, 49430863, 49547521, 49603849, 49801249, 49970761, 50112241, 50452609, 50537881, 50708641, 50794129, 50822641, 51136801, 51251281, 51509329, 51652969, 51739249, 51895117, 51940849, 51998521, 52027369, 52113961, 52258441, 52374169, 52461049, 52519009, 52606009, 53042089, 53246209, 53392249, 53421481, 53597041, 53743561, 53772889, 54007801, 54037201, 54302161, 54439939, 54656449, 54922921, 55011889, 55249489, 55517401, 55606849, 55636681, 55905529, 55965361, 56055169, 56085121, 56181887, 56235001, 56355049, 56505289, 56595529, 56685841, 56806369, 56866681, 56957209, 56987401, 57138481, 57168721, 57350329, 57410929, 57501889, 57592921, 57623281, 57805609, 57866449, 58079641, 58354321, 58415449, 58507201, 58813561, 58863869, 58874929, 58997761, 59089969, 59151481, 59274601, 59336209, 59552089, 59644729, 59706529, 59923081, 60109009, 60171049, 60202081, 60668521, 60730849, 61105489, 61199329, 61293241, 61481281, 61669609, 61889689, 61984129, 62047129, 62078641, 62141689, 62425801, 62520649, 62570773, 62710561, 62742241, 62748517, 62837329, 62932489, 62995969, 63186601, 63218401, 63409369, 63888049, 64144081, 64176121, 64272289, 64481201, 64625521, 64850809, 64947481, 65108761, 65302561, 65399569, 65431921, 65496649, 65626201, 65788321, 65885689, 65983129, 66373609, 66601921, 66699889, 66765241, 66896041, 67092481, 67108864, 67387681, 67551961, 67584841, 67749361, 67782289, 67848169, 67947049, 68277169, 68376361, 68417929, 68442529, 68674369, 68740681, 68773849, 68840209, 69072721, 69172489, 69343957, 69372241, 69772609, 69939769, 70040161, 70174129, 70341769, 70375321, 70879561, 70946929, 71048041, 71081761, 71284249, 71351809, 71588521, 71690089, 72267001, 72471169, 72607441, 72709729, 72880369, 72914521, 72982849, 73324969, 73496329, 73560059, 73633561, 73908409, 73942801, 74114881, 74356129, 74425129, 74459641, 74618461, 74666881, 74770609, 75047569, 75151561, 75290329, 75359761, 75498721, 75568249, 75672601, 75811849, 75916369, 76020961, 76230361, 76335169, 76405081, 76510009, 76615009, 76755121, 77070841, 77141089, 77492809, 77563249, 77774761, 77810041, 77986561, 78092569, 78127921, 78304801, 78517321, 78552769, 78623689, 78978769, 79085449, 79619929, 79727041, 79798489, 79941481, 80062991, 80120401, 80335369, 80442961, 80478841, 80982001, 81018001, 81126049, 81182737, 81198121, 81234169, 81522841, 81739681, 81775849, 81884401, 82065481, 82210489, 82646281, 82864609, 82973881, 83302129, 83411689, 83484769, 83740801, 83850649, 83923921, 84143929, 84290761, 84400969, 84604519, 84621601, 84695209, 84805681, 85026841, 85137529, 85359121, 85396081, 85692049, 86062729, 86136961, 86174089, 86359849, 86694721, 86843761, 86918329, 86938307, 87179569, 87254281, 87291649, 87403801, 87815641, 87928129, 88190881, 88303609, 88416409, 88529281, 88604569, 88717561, 88755241, 88943761, 88981489, 89056969, 89094721, 89510521, 89548369, 89624089, 89737729, 89851441, 90079081, 90193009, 90459121, 90518849, 90649441, 90878089, 90992521, 91145209, 91221601, 91910569, 92179201, 92409769, 92525161, 92602129, 92717641, 92756161, 92987449, 93103201, 93334921, 93644329, 93683041, 93876721, 94031809, 94458961, 94497841, 94731289, 94848121, 94926049, 95043001, 95394289, 95433361, 95443993, 95667961, 95785369, 95863681, 96098809, 96255721, 96373489, 96609241, 96687889, 96805921, 97042201, 97160449, 97199881, 97436641, 97673689, 97752769, 97972181, 98029801, 98148649, 98465929, 98585041, 98624761, 98823481, 98982601, 99252847, 99341089, 99460729, 100140049, 100180081, 100741369, 100781521, 101223721, 101344489, 101384761, 101586241, 101828281, 101847563, 101868649, 101989801, 102070609, 102232321, 102677689, 102799321, 102839881, 103042801, 103205281, 103286569, 103408561, 103571329, 103652761, 103897249, 104060401, 104264521, 104509729, 104919049, 105001009, 105124009, 105247081, 105411289, 105493441, 105534529, 105863521, 106110601, 106151809, 106357969, 106523041, 106729561, 106770889, 106853569, 106977649, 107267449, 107516161, 107972881, 108139201, 108722329, 108764041, 108847489, 109265209, 109348849, 109390681, 109474369, 109767529, 109902239, 109977169, 110229001, 110271001, 110523169, 110859841, 110901961, 111492481, 111661489, 112126921, 112296409, 112381201, 112508449, 112550881, 112635769, 112933129, 113018161, 113188321, 113443801, 113571649, 113699569, 113784889, 114211969, 114297481, 114682681, 114725521, 114982729, 115111441, 115197289, 115326121, 115501303, 115627009, 115856201, 116014441, 116229961, 116402521, 116618401, 117310561, 117440569, 117657409, 117787609, 117917881, 117961321, 118091689, 118370771, 118439689, 118570321, 118613881, 118875409, 119006281, 119617969, 119661721, 119880601, 120055849, 120406729, 120538441, 120714169, 120846049, 121066009, 121594729, 122036209, 122257249, 122301481, 122522761, 122567041, 122832889, 122921569, 123054649, 123498769, 123587689, 123632161, 123899161, 124251499, 124300201, 124523281, 124567921, 124791241, 124835929, 124925329, 125372809, 125731369, 126315121, 126405049, 126585001, 126720049, 126810121, 127080529, 127215841, 127263527, 127396369, 127667401, 127938721, 128074489, 128165041, 128346241, 128845201, 128890609, 129140163, 129254161, 129572689, 129800449, 129937201, 130210921, 130484929, 130804969, 130942249, 131033809, 131079601, 131492089, 131583841, 131859289, 131872229, 131997121, 132043081, 132181009, 132319009, 132687361, 132871729, 133379401, 133425601, 134073241, 134217728, 134258569, 134397649, 134490409, 134954689, 135047641, 135326689, 135885649, 136352329, 136445761, 136632721, 136866601, 136913401, 137288089, 137334961, 137616361, 137898049, 138697729, 138744841, 138839089, 138980521, 139263601, 139405249, 139546969, 139736041, 139877929, 139972561, 140019889, 140161921, 140730769, 140825689, 141158161, 141300769, 141420761, 141538609, 141681409, 141824281, 142157929, 142253329, 142396489, 142539721, 142587481, 142874209, 143017681, 143055667, 143256961, 143304841, 143544361, 143688169, 144168049, 144264121, 144889369, 144985681, 145033849, 145178401, 145709041, 145757329, 146337409, 146434201, 146579449, 146627881, 146724769, 146870161, 147008443, 147452449, 147598201, 147792649, 147889921, 147938569, 148035889, 148766809, 148913209, 149108521, 149499529, 149793121, 149842081, 150087001, 150136009, 150381169, 150528361, 150724729, 150822961, 151019521, 151314601, 151856329, 152004241, 152349649, 152448409, 153091129, 153190129, 153239641, 153536881, 153784801, 153983281, 154082569, 154281241, 154579489, 154678969, 155027401, 155176849, 155575729, 155725441, 155925169, 156025081, 156175009, 156325009, 156525121, 156675289, 156925729, 157226521, 157276681, 157427209, 157577809, 157979761, 158180929, 158331889, 158340421, 158482921, 158785201, 159037321, 159087769, 159239161, 159693769, 159794881, 159946609, 160098409, 160250281, 160554241, 161010721, 161213809, 161366209, 161620369, 161823841, 162282121, 162384049, 162741049, 162894169, 163047361, 163353961, 163609681, 163667323, 163814401, 164070481, 164378041, 164429329, 164583241, 164891281, 165199609, 166126321, 166229449, 166384201, 166590649, 166693921, 166848889, 166900561, 167003929, 167469481, 167780209, 167935681, 168143089, 168298729, 168454441, 168558289, 169026001, 169078009, 169182049, 169234081, 169859089, 169963369, 170119849, 170276401, 170641969, 171426649, 171583801, 171688609, 171845881, 172160641, 172318129, 172808693, 172843609, 172948801, 173159281, 173264569, 173475241, 173633329, 173791489, 173896969, 174689089, 174741961, 175006441, 175324081, 175536001, 175801081, 176013289, 176650681, 176810209, 177129481, 177235969, 177608929, 177715561, 177875569, 177928921, 178453547, 178676689, 179051161, 179479609, 179533201, 179854921, 180015889, 180123241, 180660481, 180929401, 181090849, 181252369, 181413961, 181629529, 181899169, 182223001, 182601169, 182871529, 183250369, 183683809, 184063489, 184220009, 184334929, 184715281, 184878409, 185313769, 185477161, 185695129, 185858689, 186169411, 186295201, 186841561, 187115041, 187169761, 187333969, 187443481, 187498249, 187607809, 187936681, 187991521, 188265841, 188320729, 188485441, 189090001, 189255049, 189310081, 189420169, 189915961, 190136521, 190412401, 190633249, 191241241, 191296561, 191573281, 192071881, 192100033, 192460129, 192571129, 192626641, 192737689, 193237801, 193293409, 193404649, 193571569, 193794241, 194072761, 194128489, 194965369, 195077089, 195916009, 195972001, 196252081, 196308121, 196812841, 196925089, 197430601, 197599249, 197993041, 198274561, 198330889, 198443569, 199007449, 200024449, 200194201, 200307409, 200477281, 200873929, 200987329, 201554809, 201838849, 202236841, 202262003, 202863049, 203034001, 203091001, 203946961, 204289849, 204575809, 205091041, 205148329, 205262929, 205664281, 205836409, 206468161, 206985769, 207043321, 207388801, 207561649, 207676921, 207907561, 208022929, 208253761, 208426969, 208527857, 208715809, 208773601, 209120521, 209641441, 209931121, 210337009, 210801361, 211208089, 211324369, 211498849, 211673401, 211731601, 211906249, 212022721, 212080969, 212897281, 212955649, 213773641, 213949129, 214007641, 214124689, 214300321, 214358881, 214710409, 214827649, 214921799, 215179561, 215590489, 216060601, 216472369, 216590089, 216766729, 217002361, 217081801, 217179169, 217297081, 217474009, 217651009, 217828081, 218064289, 218182441, 218418841, 218537089, 218951209, 219424969, 219662041, 219839929, 219958561, 220314649, 220552201, 221027689, 221087161, 221384641, 221622769, 221741881, 221920609, 222695929, 222875041, 223173721, 223412809, 223532401, 223648543, 223711849, 224070961, 224490289, 225390169, 225510289, 225930961, 226592809, 226833721, 227195329, 227315929, 227496889, 227738281, 228040201, 228221449, 228644641, 228947161, 229128769, 229189321, 229345007, 229492201, 229855921, 230219929, 230346397, 230644969, 230827249, 231009601, 231557089, 231861529, 232044289, 232288081, 232837081, 232959169, 233142361, 233203441, 233386729, 233692369, 233753521, 234059401, 234304249, 234487969, 234671761, 234885113, 234978241, 235039561, 235591801, 235898881, 235960321, 236329129, 236452129, 236636689, 236882881, 237176659, 237190801, 237560569, 237992329, 238362721, 238486249, 238733401, 239042521, 239228089, 239413729, 240033049, 240157009, 240591121, 241087729, 241522681, 241833601, 242082481, 242393761, 242767561, 242829889, 243391201, 243578449, 243953161, 244140625, 244265641, 244640881, 244703449, 244828609, 244891201, 245266921, 245454889, 245580241, 245831041, 245956489, 247338529, 247464361, 247527289, 247653169, 247716121, 248031001, 248409121, 248598289, 248787529, 249229369, 249355681, 249545209, 249734809, 249924481, 250177489, 250367329, 251239591, 251507881, 252079129, 252206161, 252396769, 252460321, 252841801, 253032649, 253223569, 253414561, 253541929, 253987969, 254689681, 255072841, 255136729, 255712081, 256032001, 256224049, 257057089, 257827249, 257955721, 258019969, 258148489, 258212761, 258341329, 258791569, 258920281, 259113409, 259306609, 259564321, 260080129, 260144641, 260467321, 260531881, 261889489, 262018969, 262083721, 262213249, 262991089, 263185729, 263374721, 263380441, 263445361, 264030001, 264160009, 264615289, 264810529, 265722601, 265847707, 266309761, 266766889, 266962921, 267289801, 267682321, 267747769, 267944161, 268337161, 268435456, 269320921, 269517889, 269649241, 269846329, 270043489, 270503809, 270635401, 270701209, 270840023, 271491529, 271623361, 271821169, 272019049, 272877361, 273207841, 273803209, 274001809, 274266721, 274465489, 274664329, 275659609, 275792449, 276191161, 276590161, 276656689, 277189201, 277255801, 277455649, 277588921, 277988929, 278445077, 278589481, 278656249, 278856601, 278990209, 279859441, 280261081, 280462009, 280864081, 280998169, 281803369, 282475249, 282609721, 283013329, 283215241, 283282561, 283686649, 284630641, 284900641, 285035689, 285238321, 285643801, 285711409, 286191179, 286320241, 286523329, 286658761, 286861969, 287065249, 287743369, 288286441, 288354361, 288558169, 288762049, 288804781, 289374121, 289714441, 289918729, 289986841, 290123089, 290395681, 290600209, 290804809, 291623929, 292170649, 292375801, 292649449, 292991689, 293197129, 293676769, 294431281, 294499921, 294705889, 295255489, 295461721, 295530481, 295943209, 296080849, 296149681, 296907361, 297183121, 297804049, 298978681, 299047849, 299255401, 299878489, 300017041, 300224929, 300432889, 300710281, 301057201, 301334881, 301960129, 302168689, 302307769, 302377321, 302516449, 302794801, 303351889, 303421561, 303839761, 304258249, 304467601, 304821217, 305096089, 305235841, 305445529, 305655289, 305865121, 305935081, 306145009, 306565081, 306915361, 307616521, 308037601, 308669761, 308810329, 309021241, 309091561, 309654409, 309724801, 310076881, 310288733, 310570129, 310711129, 311769649, 311840281, 312193561, 312617761, 312688489, 313537849, 313750369, 314317441, 314601169, 314956009, 315027001, 315453121, 316235089, 316448521, 316519681, 317089249, 317801929, 318158569, 318229921, 318611987, 318658201, 319086769, 319730161, 320087881, 320517409, 320732281, 320803921, 321162241, 321233929, 321449041, 321807721, 322453849, 322525681, 322956841, 323172529, 323316361, 323532169, 323604121, 324468169, 325477681, 325549849, 325694209, 325766401, 326127481, 326199721, 326777929, 327211921, 327501409, 328298161, 328370641, 328588129, 328733161, 328805689, 329168449, 329386201, 329939371, 330112561, 330548761, 330912481, 331203601, 331640521, 331859089, 332077729, 332296441, 332442289, 333099001, 333172009, 333318049, 333756361, 334414369, 334487521, 334926601, 335146249, 335292721, 335365969, 335952241, 336392281, 336832609, 337346689, 337493641, 337787641, 338449609, 338596801, 339038569, 339554329, 339775489, 339996721, 340144249, 340439401, 340660849, 340808521, 341547361, 341991049, 342361009, 342879289, 343027441, 343101529, 343694521, 343768681, 344213809, 344472101, 345327889, 345476569, 345699649, 346592689, 347337769, 348232921, 348606241, 348905041, 349353481, 349727401, 350176369, 350400961, 350850361, 351300049, 351525001, 351825049, 352275361, 352425529, 352951369, 353176849, 353327209, 353552809, 354907921, 355661881, 356039161, 356400829, 357172201, 357625921, 357701569, 357852889, 357928561, 358988809, 359443681, 359974729, 360202441, 361038001, 361342081, 361494169, 362178961, 362407369, 362940601, 363626761, 363779329, 364008241, 364084561, 364313569, 365612641, 366301321, 366377881, 366990649, 367220569, 367910761, 367987489, 368908849, 369062521, 369139369, 369369961, 369831361, 370062169, 370524001, 370909081, 371217289, 371448529, 371694959, 372065521, 372528601, 372837481, 373223761, 373301041, 373764889, 375313129, 375545641, 375623161, 375855769, 376010881, 376476409, 377019889, 377175241, 377252929, 377408329, 377486041, 377641489, 377952481, 378185809, 378574849, 378808369, 379041961, 379119841, 379353529, 379587289, 379821121, 380289001, 380523049, 381459961, 381850681, 381928849, 382319809, 382554481, 383024041, 383258929, 383493889, 384042409, 384240583, 384277609, 384512881, 386554921, 387341761, 387420489, 387577969, 387971809, 388050601, 388444681, 388760089, 389154529, 389628121, 390102001, 390181009, 390418081, 390576169, 391129729, 391762849, 392079601, 392554969, 392792761, 393665281, 393744649, 393832837, 394141609, 394459321, 394697689, 395572321, 395651881, 396527569, 396766561, 397085329, 397483969, 397962601, 398441521, 398521369, 398920729, 399160441, 399640081, 399720049, 399880009, 400440121, 400840441, 400920529, 401160841, 401882209, 402042601, 402523969, 402845041, 403567921, 403583419, 404050201, 404291449, 404532769, 404693689, 404935129, 405176641, 405740449, 405901609, 405982201, 406465921, 406949929, 407111329, 407353489, 408080401, 408807961, 409293361, 409374289, 410022001, 410172407, 410338673, 410508121, 410832361, 411562369, 411968209, 413024329, 413186929, 413430889, 413756281, 414000409, 414244609, 414407449, 414488881, 414896161, 415711321, 415874449, 416119201, 416445649, 416608921, 417425761, 417834481, 417916249, 418195493, 419307529, 419389441, 419553289, 420537049, 420619081, 421111441, 421604089, 422014849, 422261401, 422343601, 422836969, 423564751, 424071649, 424318801, 424813321, 425473129, 425968321, 426050881, 426959569, 427703761, 428200249, 428779849, 429194089, 429276961, 429774361, 430272049, 430438009, 430521001, 430687009, 430936081, 431434441, 431517529, 432182521, 432931249, 433014481, 433798093, 434680801, 435014449, 435682129, 435932641, 436266769, 436684609, 436768201, 436935409, 437688241, 438023041, 438441721, 438776809, 439279681, 439447369, 440202361, 440286289, 440711081, 441042001, 441462121, 441546169, 441714289, 441798361, 441966529, 442302961, 443481481, 443565721, 443818489, 444745921, 445252201, 445505449, 446096641, 446857321, 447026449, 447280201, 447618649, 447872569, 448126561, 448550041, 448888969, 449058481, 449143249, 449906521, 450330841, 450585529, 451435009, 452370361, 452710729, 452966089, 454243969, 454414489, 454499761, 454670329, 454756609, 455438281, 455694409, 456976129, 457061641, 457232689, 457574881, 457831609, 458002801, 458259649, 458773561, 459373489, 460832089, 461433361, 461691169, 461863081, 461889917, 461949049, 462207001, 462379009, 462981289, 463153441, 463239529, 463497841, 464704249, 464790481, 464962969, 465221761, 465566929, 465998569, 466084921, 466516801, 466603201, 467035321, 467121769, 467294689, 468592609, 468679201, 469198921, 469718929, 470152489, 470933401, 471454369, 472062529, 472497169, 472584121, 473106001, 473367049, 473802289, 474063529, 474673369, 475196401, 475370809, 475981489, 476156041, 476941921, 477029281, 477466201, 477815881, 477990769, 478340641, 478778161, 479303449, 480091921, 480881041, 481231969, 481495249, 482285521, 482988529, 483604081, 483868009, 484132009, 484572169, 485188729, 485364961, 485629369, 485717521, 486246601, 486775969, 486952489, 487217329, 487443403, 487482241, 488012281, 488100649, 488807881, 488896321, 489427129, 489692641, 489869689, 490489609, 490755409, 490932649, 491021281, 491553241, 492351721, 492529249, 492884401, 494128441, 494929009, 495463081, 495997441, 496086529, 496264729, 496353841, 496532089, 496888681, 497423809, 497602249, 499209649, 499477801, 500282689, 500372161, 500909161, 501356881, 501625609, 502163281, 503239489, 503598481, 503867809, 504137209, 504855961, 505395361, 505485289, 506261573, 506295001, 506745121, 507645961, 508096681, 508186849, 508457401, 509269489, 509450041, 509540329, 511347769, 511619161, 511709641, 512433769, 512524321, 512705449, 513067801, 513883561, 514337041, 514881481, 515153809, 515244601, 515698681, 516062089, 516243841, 516516529, 517062121, 517153081, 517608001, 518427361, 518791729, 519065089, 519247369, 519885601, 520159249, 520341721, 520615489, 522259609, 522533881, 522625321, 523082641, 523357129, 524455801, 524730649, 525372241, 526105969, 526381249, 527207521, 527299369, 527758729, 528678049, 529138009, 529475129, 529506121, 529782289, 529966441, 530242729, 530334841, 530795521, 530887681, 531440809, 531625249, 531717481, 531901969, 532271041, 532732561, 533009569, 533411731, 533563801, 534395689, 535043161, 535598449, 536339281, 536709889, 536870912, 536987929, 537729721, 538100809, 538286401, 538379209, 538657681, 539493529, 540609001, 541446361, 541911841, 542470681, 542563849, 542750209, 543402721, 543869041, 544148929, 544428889, 544708921, 545549449, 546110161, 546203641, 547513201, 548355889, 549011761, 549761809, 550324681, 550981729, 552109009, 552673081, 553387661, 553707961, 553990369, 554084521, 554555401, 554932249, 555120721, 555214969, 555403489, 556063561, 556629649, 556912801, 557101609, 557384881, 557441767, 558046129, 558235129, 558329641, 558518689, 559937569, 560221561, 560316241, 560600329, 561073969, 561168721, 562590961, 563635081, 563730049, 563920009, 564205009, 564585121, 564870289, 565155529, 565609283, 565916521, 566487601, 567058969, 567344761, 567725929, 567916561, 568011889, 569156449, 569722789, 569729161, 569920129, 570206641, 570588769, 570875449, 571162201, 571640281, 571735921, 572022889, 572597041, 573937849, 574608841, 574896529, 575088361, 575664049, 576048001, 576336049, 576912361, 577104529, 577392841, 578065849, 578354401, 578931721, 579413041, 579701929, 579990889, 580376281, 580665409, 580954609, 581147449, 581243881, 581436769, 581822641, 582401689, 582594769, 583270801, 584140561, 584624041, 584720761, 585494809, 585785209, 586753729, 587044441, 587529121, 587917009, 588111001, 589566961, 590589719, 591316489, 591900241, 592289569, 593360881, 593945641, 594043129, 594335641, 594823321, 594920881, 595701649, 595994569, 596287561, 596385241, 597264721, 597460249, 598731961, 598927729, 599319361, 600201001, 600691081, 601083289, 601573729, 601868089, 602555209, 602751601, 603734041, 604815649, 605701321, 606292129, 606686161, 607573201, 608066281, 608658241, 608954329, 609250489, 609645481, 609941809, 610534681, 611721289, 612513001, 613206169, 613404289, 614097961, 614692849, 614990401, 615486481, 616082041, 617075281, 617373409, 617572201, 617969881, 618865129, 619462321, 620358649, 620650477, 620856889, 620956561, 621155929, 622153249, 622652209, 623351089, 623550841, 623850529, 623950441, 624450121, 625650169, 626550961, 626651089, 626851369, 627853249, 628655329, 629357569, 629422793, 629859409, 630562321, 630863689, 631064641, 631366129, 632371609, 632673409, 633176569, 633478561, 633579241, 633839779, 634183489, 634485721, 635997961, 636502441, 636906169, 637209049, 637411009, 637714009, 638118121, 640140601, 640241809, 640444249, 640545481, 641153041, 642064921, 642267649, 642571801, 642735647, 642977449, 643484689, 643789129, 644702881, 645617281, 645718921, 646328929, 647142721, 647549809, 647855209, 648058849, 648364369, 648669961, 648771841, 651423529, 652138369, 652342681, 653364721, 654182929, 654285241, 654489889, 654796921, 655411201, 655513609, 655820881, 656435641, 657050689, 657358321, 657563449, 658281649, 658794889, 659102929, 659411041, 660130249, 660644209, 661364089, 662187289, 662599081, 662908009, 663526081, 663732169, 664144441, 665278849, 665588401, 665691601, 666620761, 667757281, 668067409, 668170801, 669101689, 669412129, 670240321, 670965409, 671483569, 671794561, 672416761, 672520489, 672831721, 673039249, 673454401, 674388961, 674526133, 675012361, 675844009, 675948001, 676156009, 676884289, 677092441, 677508841, 678133681, 678758809, 680322889, 681157801, 681575449, 681784321, 681888769, 682202161, 683351881, 683797841, 683979409, 684397921, 684921241, 685235329, 685549489, 685863721, 686597209, 686911681, 687855529, 688380169, 688465387, 689010001, 689115001, 689640121, 689745169, 689955289, 691321849, 691532209, 692163481, 692584489, 692795041, 693742921, 694164409, 694691449, 695429641, 696273769, 696590449, 696907201, 697329649, 697857889, 697864103, 698174929, 698597761, 698914969, 699549601, 700078681, 701137441, 701667121, 702091009, 702303001, 702939169, 704318521, 705274249, 705486721, 705911761, 706124329, 707081281, 707400409, 708997129, 709316689, 709742881, 710062609, 711235561, 711875761, 711982489, 712195969, 712516249, 712836601, 712943401, 713477521, 713584369, 713798089, 714118729, 714439441, 714546361, 714867169, 714924299, 716044081, 717007729, 717329089, 718293601, 718936969, 719366041, 720009889, 720331921, 720868801, 721513321, 721620769, 722480641, 722588161, 723125881, 723233449, 723771409, 724740241, 725063329, 726140809, 726356401, 726464209, 726787681, 727974361, 728298169, 728622049, 729594121, 729918289, 730674961, 731323849, 732189481, 732297721, 732622489, 732947329, 733163929, 733922281, 734572609, 734789449, 734897881, 735874129, 736742449, 738698041, 739350481, 739676809, 740438521, 741963121, 742072081, 742726009, 743053081, 743707441, 744034729, 744252961, 744362089, 745235401, 746142643, 746874241, 747311569, 748624321, 748952689, 750595609, 751143649, 751253281, 752240329, 752459761, 752788969, 753447601, 753886849, 755095441, 755205361, 755535169, 756058031, 756745081, 757735729, 757845841, 758396521, 758506681, 759057601, 760711561, 760821889, 762367321, 762698689, 763472161, 764356609, 764688409, 765794929, 766680721, 766791481, 767123809, 767345401, 769119289, 769341169, 769452121, 769674049, 770007001, 770118001, 770784169, 771006289, 771339529, 771672841, 772339681, 772450849, 772784401, 773006809, 773340481, 773785489, 774119329, 774341929, 775455409, 775678201, 776151559, 777461689, 777796321, 778019449, 778465801, 779358889, 779470561, 780699481, 780811249, 781034809, 781370209, 781817521, 782153089, 783048289, 783832009, 784056001, 785064361, 785512729, 785736961, 786858601, 787195249, 787868761, 788542561, 788879569, 789441409, 789553801, 790115881, 790228321, 790903129, 792478801, 793154569, 794168761, 794281489, 795296401, 795860521, 796311961, 796876441, 799588729, 799701841, 799928089, 800267521, 800720209, 801286249, 801399481, 801765089, 801965761, 803665801, 803779201, 805821769, 806162449, 806730409, 807071281, 807184921, 808208041, 808435489, 808776721, 809231809, 810142369, 810939529, 811851049, 812193001, 812991169, 813219289, 814360369, 814588681, 814931209, 815045401, 815616481, 815730721, 816302041, 816416329, 816759241, 817445281, 817788409, 818131609, 818360449, 819047161, 819161641, 819505129, 819734161, 820421449, 820765201, 821223649, 821452921, 821567569, 821911561, 822656953, 822943969, 823517809, 823862209, 824321521, 825010729, 825355441, 826620001, 826735009, 827080081, 827770441, 828806521, 829036849, 829843249, 830188969, 830419489, 831572569, 831918649, 832841881, 833237621, 833303689, 833534641, 833996641, 835267801, 835730281, 836424241, 836771329, 837118489, 838044601, 838739521, 839782441, 841522081, 841986289, 842218441, 842334529, 842566729, 842915089, 844425481, 844596301, 844657969, 845471929, 846868201, 848149129, 848498641, 848615161, 848964769, 849278123, 849547609, 849897409, 850713889, 851063929, 851414041, 852114481, 852698401, 853048849, 853165681, 853866841, 854451361, 855153049, 855621001, 856674361, 857728369, 858314209, 858665809, 859134721, 860072929, 860424889, 860776921, 861246409, 862185769, 863360689, 863595769, 863713321, 864301201, 864418801, 865006921, 865523177, 865712929, 866066041, 866536969, 866890249, 867479209, 868657729, 869247289, 870309001, 871843729, 872079961, 872434369, 874207489, 874325761, 874562329, 875035561, 875390569, 876100801, 876811321, 877877641, 878114689, 878588881, 879893569, 880249561, 880368241, 881080489, 883100089, 883456729, 884527081, 885241009, 885598081, 885717121, 887384521, 887503681, 888218809, 889172761, 890007889, 890246569, 891082201, 891798769, 892037689, 892396129, 892754641, 892874161, 893871739, 895026889, 895266241, 895625329, 895745041, 896822809, 897541681, 898980289, 899340121, 900660121, 900780169, 901740841, 902822209, 903543481, 904231063, 904265041, 905347921, 905468281, 905829409, 906190609, 906551881, 906792769, 907154161, 907997689, 908238769, 908359321, 909685921, 910168561, 910892761, 911254969, 911858809, 912221209, 912704521, 913429729, 914518081, 915244009, 915498611, 915607081, 916212361, 916333441, 917665849, 918514249, 918877969, 919241761, 919484329, 920576281, 920940409, 922154689, 923491321, 923612881, 924342409, 925802329, 926045761, 927141601, 928238089, 928359961, 929701081, 929823049, 930067009, 930799081, 931287289, 932019841, 932574833, 932630521, 933485809, 933730249, 933852481, 934952929, 935931649, 938258161, 938625769, 938993449, 939361201, 940096921, 940710241, 941078329, 941814721, 942305809, 942674209, 942919849, 943288369, 944148529, 945993049, 946362169, 946977529, 947469961, 948824809, 949194481, 949687489, 949862087, 950427241, 951043921, 951167281, 951784201, 951907609, 952277881, 952895161, 953018641, 953636161, 954377449, 955489921, 956726761, 957097969, 957345481, 957840601, 959202841, 959574529, 959946289, 961806169, 962178361, 963047089, 963419521, 964164601, 964909969, 965282761, 965904241, 966028561, 966650281, 968516641, 968641129, 969637321, 970135609, 970384801, 970509409, 970883281, 972005329, 972254761, 972379489, 972753721, 973003249, 973242271, 974625961, 974875729, 975375361, 975750169, 976375009, 976500001, 976750009, 977125081, 977625289, 977875441, 978250729, 980128249, 980879761, 981005041, 981380929, 981756889, 982007569, 983261449, 984641641, 985143769, 985394881, 985520449, 985771609, 990297961, 990801529, 991026973, 991053361, 991557121, 992943121, 993069169, 993321289, 994203961, 994834681, 994960849, 995213209, 996475489, 996854329, 997485889, 998623201, 999002449, 1000267129, 1001279449, 1001659201, 1002165649, 1002545569, 1002798889, 1004065969, 1004826601, 1006221841, 1006348729, 1006602529, 1006729441, 1007491081, 1008126001, 1009269361, 1009396441, 1010794849, 1011176401, 1012321489, 1014231409, 1014358801, 1014995881, 1015888129, 1016525689, 1017035881, 1018056649, 1021249849, 1021633369, 1022272729, 1022784361, 1023424081, 1024192009, 1024576081, 1025728729, 1025856841, 1026625681, 1027243729, 1027266601, 1027651249, 1027779481, 1028035969, 1028420761, 1028933929, 1029318889, 1029703921, 1030345801, 1031501689, 1031630161, 1033043881, 1033172449, 1034201281, 1035101929, 1035745489, 1036131721, 1036260481, 1037033209, 1037677369, 1038966289, 1039224169, 1039509197, 1040127001, 1040514049, 1040772121, 1043096209, 1043225401, 1043483809, 1043871481, 1044647041, 1044776329, 1045034929, 1045940281, 1046716609, 1047104881, 1047363769, 1047752161, 1047881641, 1048270129, 1048529161, 1049824801, 1050472921, 1050602569, 1051250929, 1051640041, 1052418481, 1052548249, 1054106089, 1054885441, 1055665081, 1056055009, 1056445009, 1056705049, 1058089859, 1058265961, 1058396089, 1058656369, 1060218721, 1060348969, 1060739761, 1061000329, 1061391241, 1061912569, 1062955609, 1063346881, 1063477321, 1064129641, 1064332261, 1064912689, 1065826609, 1066218409, 1068439969, 1068832249, 1069747849, 1070140369, 1070402089, 1070532961, 1072497001, 1073283121, 1073741824, 1073938441, 1074462841, 1074725089, 1075118521, 1075643209, 1075905601, 1076036809, 1077874561, 1078005889, 1078399921, 1078662649, 1080371161, 1081554769, 1083002281, 1083133921, 1083528889, 1084582489, 1084977721, 1085109481, 1086163849, 1086954961, 1087086841, 1087878289, 1088142169, 1088538049, 1088934001, 1089858169, 1090518529, 1090914841, 1091443369, 1092236401, 1092500809, 1093691041, 1093823329, 1094484889, 1095014281, 1095912791, 1096073449, 1096470769, 1096868161, 1098856201, 1098988801, 1099651921, 1100846041, 1100978761, 1101642481, 1102173601, 1102302937, 1102439209, 1102970521, 1103767729, 1105363009, 1108024369, 1108157521, 1108956601, 1109622721, 1110022489, 1110822241, 1110955561, 1111755649, 1112022409, 1112155801, 1112422609, 1112822881, 1114024129, 1114958881, 1115760409, 1116161281, 1116428569, 1117364329, 1119370849, 1119638521, 1120173961, 1120843441, 1121379169, 1121622319, 1121781049, 1122451009, 1123657441, 1124193841, 1124462089, 1125401209, 1126474969, 1126877761, 1127414929, 1127683561, 1128086569, 1128220921, 1128892801, 1129027201, 1129833769, 1130102689, 1130237161, 1130506129, 1130909641, 1131447769, 1131716881, 1132120609, 1134275041, 1135892209, 1136566369, 1137105841, 1138320121, 1138995001, 1139130001, 1139535049, 1140210289, 1140345361, 1140615529, 1141831681, 1142237209, 1143048481, 1143183721, 1144265929, 1144401241, 1145890201, 1146296449, 1146702769, 1147244641, 1148464321, 1148735449, 1149955921, 1150769929, 1151312761, 1151719969, 1151991481, 1153349521, 1153757089, 1154320649, 1155796009, 1157292361, 1158108961, 1158245089, 1158653521, 1159879249, 1160151721, 1160935651, 1162261467, 1164379129, 1164652129, 1164788641, 1165607881, 1166017609, 1166700649, 1166837281, 1167657241, 1168477489, 1170392521, 1170529369, 1170803089, 1171761361, 1173268009, 1173679081, 1173816121, 1174227289, 1174638529, 1175324089, 1176284209, 1176558601, 1176695809, 1177381969, 1177793761, 1178342929, 1179029569, 1179991201, 1180678321, 1181090689, 1181228161, 1182053161, 1183566409, 1184805241, 1185356041, 1186044721, 1187284849, 1188111961, 1188249841, 1189077289, 1189353169, 1190181001, 1190319001, 1191009121, 1191147169, 1191561361, 1192804369, 1193218849, 1193633401, 1194389981, 1195983889, 1196398921, 1196537281, 1197367609, 1197644449, 1198059769, 1199306161, 1200553201, 1200691801, 1201157047, 1201800889, 1202216929, 1202633041, 1203187969, 1203604249, 1204298209, 1205547841, 1206103441, 1206798121, 1207354009, 1208049049, 1208188081, 1208466169, 1209717961, 1211527249, 1212362761, 1213895281, 1214034649, 1214313409, 1214452801, 1215986641, 1216405129, 1216823689, 1217800609, 1218917569, 1219336561, 1220703125, 1220733721, 1221432601, 1221611509, 1222271521, 1222411369, 1223670361, 1226610529, 1226890729, 1228572601, 1228712809, 1229133481, 1229834761, 1230676561, 1230816889, 1231237921, 1231939801, 1232501449, 1232782321, 1233203689, 1234046641, 1234889881, 1235452201, 1235733409, 1236155281, 1236999241, 1239110401, 1240518841, 1240941529, 1242633001, 1243056049, 1243761289, 1244607841, 1244748961, 1245454681, 1246866721, 1247290489, 1247714329, 1247996929, 1248844921, 1249834609, 1250541769, 1251815161, 1252664449, 1253230801, 1253655649, 1254505561, 1254788929, 1255780969, 1256489809, 1256631601, 1257482521, 1259611081, 1260747049, 1260889081, 1261741441, 1262167729, 1262451961, 1262594089, 1262878369, 1263304849, 1265153761, 1265438329, 1266719281, 1266861649, 1267146409, 1267573609, 1268570689, 1272420241, 1272848329, 1276561441, 1276704361, 1277848009, 1278277009, 1278706081, 1279564441, 1281425209, 1281711601, 1281854809, 1282284481, 1283860561, 1284290569, 1284365503, 1284433921, 1285294201, 1286154769, 1286585161, 1287302641, 1288594609, 1288738201, 1289599921, 1290461929, 1291180489, 1292474401, 1293337369, 1293768961, 1294344529, 1294776289, 1295496049, 1295928001, 1296504049, 1296792121, 1296936169, 1297224289, 1298596571, 1298665369, 1300395721, 1300828489, 1301261329, 1301982889, 1302993409, 1303715449, 1303859881, 1305449161, 1305751357, 1305882769, 1306894801, 1307617921, 1309498969, 1309788481, 1311091681, 1311671089, 1312540441, 1313410081, 1314135001, 1315005169, 1315440361, 1316020729, 1317181849, 1317617401, 1318198249, 1318633969, 1319069761, 1320139673, 1320668281, 1320813649, 1321540609, 1322995129, 1323722689, 1324159321, 1327363489, 1328675401, 1329112849, 1329842089, 1329987961, 1330279729, 1330717441, 1330863361, 1331739049, 1332031009, 1333929529, 1334221729, 1334367841, 1335244681, 1335975601, 1336560481, 1336852969, 1337438041, 1338315889, 1338608569, 1339486801, 1340072449, 1341683641, 1341919727, 1342269769, 1342709449, 1343442409, 1344762241, 1345202329, 1345642489, 1346229481, 1346669809, 1347550681, 1347844369, 1348431841, 1349754121, 1350125107, 1350489001, 1351371121, 1351812289, 1352694841, 1352841961, 1353283369, 1353577681, 1353724849, 1354902481, 1355786041, 1356669889, 1357701409, 1358438449, 1359470641, 1359913129, 1360650769, 1361536201, 1361683801, 1362569569, 1363012561, 1363307929, 1363751041, 1363898761, 1363938029, 1364785249, 1365080809, 1367002729, 1367446441, 1368778009, 1369222009, 1369962169, 1370406361, 1370554441, 1371887521, 1372628401, 1373221249, 1373517721, 1375445569, 1376187409, 1377671689, 1378117129, 1379305321, 1380791281, 1381683241, 1382426761, 1383021721, 1383765601, 1383914401, 1385105089, 1385551729, 1387041049, 1387488001, 1387786009, 1389276529, 1389574729, 1391812249, 1391961481, 1392259969, 1392857041, 1393668613, 1394051569, 1394200921, 1395545449, 1395844321, 1395993769, 1396442161, 1397189641, 1398535609, 1399433281, 1400480929, 1401828481, 1402277809, 1403476369, 1404975289, 1405425121, 1405725049, 1406325001, 1406775049, 1407075121, 1407525289, 1408425841, 1409026369, 1409777209, 1409927401, 1410828721, 1411279489, 1411580041, 1411730329, 1412181241, 1412932921, 1413083281, 1414286449, 1415189161, 1416242689, 1416247867, 1416995449, 1417447201, 1418049649, 1418501569, 1420611481, 1420762249, 1421214601, 1422572089, 1424836009, 1427403961, 1427555089, 1428764401, 1429671721, 1429822969, 1431184561, 1432395409, 1432849609, 1433455321, 1434212641, 1434818641, 1435576321, 1436182609, 1436940649, 1439069689, 1440278401, 1440733849, 1441189369, 1441493089, 1443012169, 1443316081, 1443468049, 1443772009, 1444836121, 1446965521, 1447574209, 1448030809, 1449248761, 1450314889, 1452600769, 1453058161, 1455346201, 1455651409, 1456719889, 1457483329, 1457941489, 1458399721, 1459010809, 1459316401, 1460691961, 1461609361, 1462068169, 1462221121, 1463904121, 1464822529, 1465434961, 1465894369, 1466813401, 1467119809, 1468192489, 1468499041, 1468958929, 1469112241, 1469418889, 1470799201, 1472333641, 1472794129, 1474022449, 1476941761, 1478171809, 1478325601, 1478633209, 1479094681, 1479248521, 1482327001, 1485562849, 1486642249, 1486950721, 1487413489, 1487567761, 1489419649, 1490191609, 1490654881, 1490809321, 1492199641, 1492972321, 1493899801, 1494054409, 1495291561, 1495446241, 1495910329, 1497148249, 1497612601, 1498231849, 1498541521, 1498696369, 1499470729, 1499935441, 1500555169, 1501330009, 1501485001, 1502880289, 1504121089, 1504741681, 1505672809, 1506138481, 1507070041, 1508001889, 1508467921, 1509400201, 1510177321, 1510643689, 1511110129, 1512509881, 1513443409, 1514532889, 1514844241, 1514999929, 1515778489, 1517336209, 1517803681, 1518738841, 1519206529, 1520454049, 1522482361, 1522794529, 1524199681, 1524355849, 1524668209, 1524845951, 1527168241, 1527949921, 1528575409, 1529044609, 1529357449, 1529826769, 1530296161, 1531391689, 1531861321, 1532808577, 1533270649, 1533583921, 1533740569, 1535150761, 1535934481, 1536561601, 1537345681, 1537973089, 1538757529, 1538914441, 1539228289, 1539699121, 1539856081, 1540641001, 1543939849, 1544568601, 1545511969, 1545826489, 1546298329, 1547714281, 1547871649, 1549130881, 1549760689, 1550075641, 1550233129, 1551020689, 1552123609, 1553069281, 1553857561, 1555434721, 1555750249, 1556381401, 1557170521, 1560171001, 1560487009, 1560961081, 1561119121, 1561909441, 1563490681, 1564281601, 1565230969, 1565705761, 1566655561, 1568239201, 1568714449, 1569665161, 1569982129, 1570616161, 1572836281, 1573037747, 1573470889, 1573788241, 1574423041, 1576328209, 1576804681, 1577598961, 1578234529, 1578711289, 1579983001, 1580937121, 1581573361, 1582368841, 1583323681, 1583960401, 1585712041, 1586189929, 1586349241, 1587145921, 1587305281, 1587783409, 1588580449, 1589058769, 1589537161, 1590175129, 1590653689, 1590972769, 1592089801, 1594325041, 1594963969, 1596242209, 1597680841, 1598320441, 1598640289, 1599120121, 1600720081, 1601040169, 1602480961, 1602961369, 1603121521, 1605043969, 1605723211, 1606967569, 1607448649, 1607929801, 1608892321, 1609855129, 1610176129, 1610336641, 1612102801, 1612263409, 1613066569, 1613548561, 1614191329, 1615155721, 1615477249, 1617085369, 1618533361, 1619016169, 1619338081, 1620304009, 1622236729, 1622720089, 1623203521, 1627557649, 1628203201, 1628687449, 1629010321, 1631109769, 1634018929, 1634342329, 1634504041, 1634827489, 1636930681, 1637901841, 1638873289, 1639197169, 1639683049, 1640169001, 1640817049, 1641789361, 1642599841, 1642761961, 1643734849, 1645032481, 1646492929, 1646979889, 1647212741, 1647629281, 1648116409, 1649090881, 1650553129, 1651365769, 1651528321, 1655920249, 1656245809, 1656408601, 1657222681, 1659666121, 1660644001, 1661296081, 1661622169, 1662274441, 1663579369, 1664721601, 1665700969, 1666190761, 1666517329, 1667007241, 1667987281, 1668477409, 1668640801, 1668967609, 1670111689, 1671092641, 1671419689, 1672446203, 1672564609, 1673055409, 1675019329, 1675510489, 1676001721, 1676820601, 1677803521, 1678786729, 1680426049, 1681902121, 1682394289, 1682886529, 1684199521, 1684856209, 1685184601, 1685677249, 1687319929, 1687648561, 1690278769, 1690607689, 1691759161, 1692581881, 1692746449, 1693240201, 1694227921, 1695545329, 1695710041, 1696039489, 1696533721, 1697522401, 1697687209, 1697936057, 1698511369, 1699170841, 1699665529, 1699995361, 1700160289, 1700985049, 1702140049, 1702635169, 1703130361, 1704120961, 1705607401, 1708416889, 1709078281, 1709905201, 1710401449, 1712387161, 1712883769, 1713049321, 1713877201, 1714870921, 1715036569, 1717522249, 1718351209, 1719512089, 1720507441, 1721503081, 1722831049, 1723329169, 1723827361, 1723993441, 1725488521, 1725820849, 1726319401, 1728813241, 1729977649, 1730310409, 1730809609, 1731308881, 1731475321, 1731974689, 1732307641, 1732323601, 1732807129, 1733972881, 1734472609, 1734805801, 1735472281, 1736305561, 1737305761, 1737805969, 1740474961, 1741309441, 1741977169, 1743814081, 1743981121, 1744816441, 1745317729, 1747323601, 1747992481, 1748326969, 1750836649, 1751338801, 1751506201, 1752510769, 1753850641, 1754520769, 1755023449, 1755358609, 1755861409, 1756531921, 1757873329, 1759047481, 1759550809, 1760054209, 1760389849, 1760557681, 1761396961, 1762404361, 1762572289, 1763916001, 1765092169, 1765428289, 1765596361, 1765932529, 1767613849, 1769127721, 1769969041, 1770137329, 1770978889, 1771483921, 1772494201, 1775021161, 1775695321, 1777212649, 1778224561, 1779068041, 1779236761, 1779742969, 1780249249, 1780586809, 1781599681, 1782612841, 1782781729, 1783119529, 1784133121, 1784770597, 1785654049, 1787682961, 1787852089, 1788697849, 1789205401, 1789882249, 1791236329, 1791913561, 1792421569, 1793437801, 1794284881, 1795471129, 1795979641, 1796996881, 1797505609, 1798014409, 1798353649, 1798523281, 1800559489, 1800898969, 1801408249, 1802087401, 1802485313, 1802596849, 1802936521, 1803106369, 1803446089, 1803955729, 1804229351, 1805145169, 1805485081, 1806165001, 1807015081, 1809056089, 1811098249, 1812119761, 1812290041, 1812800929, 1813822921, 1815697321, 1818254881, 1818425449, 1818937201, 1820472889, 1821326329, 1821838489, 1822350721, 1823033809, 1823375401, 1823546209, 1824058681, 1824912961, 1825596529, 1826451169, 1826964049, 1827648001, 1829016289, 1829276567, 1829529529, 1830727369, 1831240849, 1831583209, 1833638041, 1834323241, 1835179921, 1835351281, 1836379609, 1836893881, 1837236769, 1840324201, 1840495801, 1842383929, 1842899041, 1843585969, 1844101249, 1844960209, 1845647521, 1846163089, 1847194441, 1848054121, 1849258009, 1850118169, 1850634361, 1852183369, 1853216401, 1853388601, 1854421969, 1854766489, 1856331989, 1857006649, 1857868609, 1859075689, 1860455689, 1862008801, 1862699281, 1864253329, 1865289721, 1865409391, 1866326401, 1866844849, 1868227729, 1869438169, 1871514121, 1872379441, 1873418089, 1874110681, 1876015969, 1876535761, 1876709041, 1877575561, 1882778881, 1883299609, 1883473201, 1883820409, 1884514921, 1885904329, 1887120481, 1887989401, 1888510849, 1890597361, 1891119169, 1892163001, 1892819053, 1893729289, 1895818681, 1895992849, 1898606329, 1898954929, 1899129241, 1900175281, 1900698409, 1901570449, 1901744881, 1902093769, 1903315129, 1903838689, 1905235201, 1905409801, 1906282921, 1906981561, 1908903481, 1910651521, 1911176089, 1911525841, 1914325009, 1914850081, 1916425729, 1916775961, 1916951089, 1917301369, 1917476521, 1917826849, 1918527601, 1923085609, 1924313689, 1926244321, 1926419881, 1928351569, 1930108489, 1930987249, 1931690401, 1932569521, 1932745369, 1933272961, 1933624729, 1934856169, 1935208081, 1935736009, 1937496289, 1937848441, 1938376729, 1938552841, 1939609681, 1940666809, 1941195481, 1942253041, 1943663569, 1943839921, 1944898201, 1945780321, 1946486161, 1946839129, 1947368641, 1947545161, 1948441249, 1950017281, 1951077241, 1951784041, 1952667721, 1953728401, 1953905209, 1954258849, 1955496841, 1957974001, 1958682049, 1959213169, 1959567289, 1959744361, 1960098529, 1960629841, 1960806961, 1961869849, 1967011201, 1967543449, 1968785641, 1969673161, 1969850689, 1970383321, 1972869889, 1975713601, 1976069209, 1977326743, 1978737289, 1979449081, 1979983009, 1980339001, 1980873049, 1981941361, 1982119441, 1983009961, 1983188089, 1983544369, 1984078849, 1984613401, 1985860969, 1987287241, 1988000569, 1990676689, 1991033641, 1991212129, 1992104689, 1992818881, 1993354609, 1993711801, 1994247649, 1995616979, 1996570489, 1996927969, 1998000601, 1998179401, 1999073521, 2000683441, 2001757081, 2002831009, 2004442441, 2004621529, 2004979729, 2006054521, 2006771209, 2007846481, 2008742761, 2010535921, 2010894649, 2011612201, 2013047689, 2014124641, 2014842769, 2015381449, 2016818281, 2017536889, 2018435329, 2019513721, 2020772209, 2021311681, 2021671369, 2022390841, 2023470289, 2023830169, 2025630049, 2026170169, 2029772809, 2030493721, 2031935929, 2032476889, 2035724161, 2035904641, 2036446129, 2036807161, 2037348769, 2037529321, 2039515921, 2041142041, 2041322761, 2042226481, 2042768809, 2046024289, 2047291009, 2048377081, 2048739169, 2050368961, 2051093521, 2051455849, 2052724249, 2053630489, 2053811761, 2054718241, 2055443569, 2055806281, 2055987649, 2057620321, 2059072129, 2060161321, 2061432409, 2062340569, 2063612329, 2064157489, 2064702721, 2068521361, 2069431081, 2069977009, 2070523009, 2072343529, 2073071593, 2073254089, 2073982681, 2075075809, 2075440249, 2076533761, 2078174569, 2078356921, 2079268801, 2080545769, 2082188161, 2082440933, 2083100881, 2084744281, 2085474889, 2086022929, 2086388329, 2087667481, 2088215809, 2089129849, 2091873169, 2092240639, 2093154001, 2093703049, 2094252169, 2094618289, 2095716841, 2099197489, 2099564041, 2099747329, 2100113929, 2100663889, 2101397281, 2102497609, 2103414769, 2103965161, 2105616769, 2106167449, 2110759249, 2111310601, 2111678209, 2111932187, 2112229681, 2113332841, 2114068441, 2114988121, 2117932441, 2118484729, 2120510401, 2120694601, 2121615721, 2122721329, 2124380281, 2124564649, 2125117801, 2125486609, 2128253689, 2128991881, 2129545609, 2130099409, 2131761241, 2132684761, 2132869489, 2133238969, 2134347601, 2136195961, 2137120441, 2137860169, 2140080121, 2141005441, 2141190529, 2141700569, 2141745841, 2143782601, 2144338249, 2144523481, 2146190929, 2147117569, 2147483648, 2148229801, 2148415201, 2151197161, 2151685171, 2152867201, 2153980921, 2156580721, 2156766481, 2157323809, 2157695401, 2158252849, 2159553841, 2160111529, 2161227121, 2162157001, 2162901049, 2163273121, 2164389529, 2166809401, 2167740481, 2168485489, 2169044329, 2170534921, 2170721281, 2171653201, 2173331161, 2174636689, 2175196321, 2175569449, 2176129201, 2177435569, 2178929041, 2179115761, 2179675969, 2180049481, 2181170209, 2181825073, 2183038729, 2183412529, 2185282009, 2185656001, 2186217049, 2187339361, 2187526441, 2190895249, 2191269721, 2191831489, 2192018761, 2192955241, 2193142561, 2195203609, 2195953321, 2196515689, 2197453129, 2198578321, 2199703801, 2201392561, 2202073901, 2202706489, 2204959849, 2208342049, 2208718009, 2210598289, 2212245127, 2212855681, 2213796601, 2214361249, 2214549481, 2217185569, 2217750649, 2219446321, 2220200161, 2220577129, 2221142641, 2221896769, 2222462449, 2222839609, 2223028201, 2224159921, 2226801721, 2228500849, 2229822841, 2231334169, 2232657001, 2232681443, 2234358361, 2235303841, 2236060369, 2236627849, 2237006209, 2237573809, 2238141481, 2238898489, 2240980921, 2242117201, 2242306609, 2243253769, 2244959161, 2245527769, 2245717321, 2247423649, 2248371889, 2248561561, 2249699761, 2250648481, 2252356681, 2255395081, 2255965009, 2256345001, 2256915049, 2257485169, 2258245441, 2258815729, 2259386089, 2260336849, 2262238969, 2262809761, 2263951561, 2264903281, 2265664801, 2266616881, 2267950129, 2268521641, 2269474321, 2270808409, 2271189649, 2271380281, 2273477761, 2275194601, 2275385401, 2276339521, 2276530369, 2276912089, 2278821169, 2279203081, 2279394049, 2282641729, 2282832841, 2283979681, 2284553209, 2285509249, 2285700481, 2286656761, 2288378569, 2288952649, 2290292449, 2291441161, 2292590161, 2294697409, 2294744759, 2295463921, 2296038889, 2297572489, 2298147721, 2298914809, 2299298401, 2300449369, 2301024961, 2301792529, 2302176361, 2305199161, 2305632289, 2306208529, 2306784841, 2308706401, 2311013329, 2311590241, 2312744281, 2314475881, 2315438161, 2315630641, 2316593161, 2319096649, 2319674569, 2321216041, 2321986969, 2322565249, 2322950809, 2325264841, 2327001121, 2327773009, 2328931081, 2330089441, 2331054961, 2332793401, 2333952721, 2334145969, 2336465569, 2336752783, 2336852281, 2338012609, 2339753641, 2340914689, 2342269609, 2343237649, 2343431281, 2343818569, 2346142969, 2347305601, 2348662369, 2349631729, 2350213441, 2350407361, 2350989169, 2351377081, 2351959009, 2354481529, 2354869729, 2355452089, 2356034521, 2356228681, 2357947691, 2358364969, 2359142041, 2360890921, 2361279649, 2363029321, 2363807161, 2364196129, 2366530609, 2366725201, 2367892921, 2369060929, 2369450329, 2369645041, 2374710361, 2374905289, 2376660001, 2377245049, 2377635121, 2378220289, 2379390841, 2379585961, 2380171369, 2381342401, 2382318481, 2383099489, 2383490041, 2383685329, 2386029409, 2387006449, 2387201881, 2388179161, 2388374641, 2389547689, 2390134321, 2391894649, 2395808809, 2396396209, 2398354729, 2399922121, 2400118081, 2401294009, 2401882081, 2402862361, 2404038961, 2404235089, 2404627369, 2405215849, 2406589249, 2407766761, 2408944561, 2411104609, 2411693881, 2412479689, 2412872641, 2413069129, 2414641321, 2416410649, 2417590561, 2417787241, 2418377329, 2419951249, 2420541601, 2420738401, 2421328849, 2421722521, 2422903729, 2425858009, 2426646121, 2428222729, 2428419841, 2430194209, 2431180249, 2433547561, 2433744889, 2434336921, 2436705769, 2437100689, 2437298161, 2439470881, 2439668449, 2441249281, 2441446921, 2442039889, 2443226041, 2443621489, 2445401401, 2446192681, 2446588369, 2447973529, 2448369361, 2450151001, 2452527529, 2453121841, 2453319961, 2453914369, 2454905209, 2455103401, 2456094481, 2459862409, 2460457609, 2461449769, 2462839129, 2463434689, 2464030321, 2466413569, 2466810889, 2467009561, 2468201761, 2469791809, 2471183521, 2472774529, 2472973441, 2473968121, 2474167081, 2474764009, 2475759049, 2478347089, 2478745369, 2478944521, 2480139601, 2480737249, 2481135721, 2482331329, 2483128561, 2484324649, 2485321609, 2487116641, 2487715129, 2489111881, 2491906561, 2492106241, 2492705329, 2493703969, 2493903721, 2494303249, 2495701849, 2499100081, 2499300049, 2499900001, 2502100441, 2502300529, 2503301089, 2504702209, 2505102601, 2505302809, 2506904761, 2507705929, 2508707569, 2509308649, 2510110201, 2511112321, 2511914161, 2512315129, 2512916641, 2513117161, 2514721609, 2515323409, 2515925281, 2517731329, 2520742849, 2521008881, 2522148841, 2522751529, 2523153361, 2526168121, 2526369169, 2527374529, 2528782369, 2529184681, 2531196721, 2532203041, 2533008241, 2533410889, 2534216281, 2536028881, 2536431769, 2537842129, 2538446689, 2538849769, 2541268921, 2541873889, 2542478929, 2544294481, 2546110681, 2546312521, 2549947009, 2550553009, 2551563169, 2552977729, 2554190521, 2554497863, 2554594849, 2555201401, 2555403601, 2558437561, 2559044569, 2559449281, 2559651649, 2560258801, 2563093129, 2565118609, 2565523801, 2565726409, 2567550241, 2568766489, 2571199849, 2572822729, 2574649081, 2575867009, 2577288289, 2577897529, 2578303729, 2579522521, 2582774041, 2583993889, 2584603921, 2585620801, 2586434449, 2587451689, 2588062129, 2588282117, 2589893881, 2590097449, 2591726281, 2593151929, 2593763041, 2596004401, 2596615849, 2597838961, 2598042841, 2599878121, 2600286049, 2601102001, 2604162961, 2605387849, 2605796209, 2607021481, 2607225721, 2608247041, 2612129881, 2614379161, 2614583689, 2614992769, 2616424801, 2617038649, 2618266561, 2620723249, 2621132809, 2621337601, 2621747209, 2623181089, 2624410441, 2625435121, 2625640081, 2627280049, 2627895169, 2629946089, 2630356369, 2632408249, 2633789341, 2634666241, 2635898281, 2636103649, 2636514409, 2636719801, 2637952321, 2640212689, 2642679649, 2643296569, 2643913561, 2644119241, 2644736329, 2645147761, 2645764969, 2645970721, 2646999601, 2648234521, 2649469729, 2650087441, 2650293361, 2650911169, 2652559009, 2653383121, 2654001289, 2654413441, 2655237841, 2656268521, 2657505601, 2658742969, 2660186929, 2660599561, 2661837649, 2662456801, 2663282449, 2663901769, 2665760161, 2666379769, 2667412609, 2668652281, 2670098929, 2670719041, 2671132489, 2671959481, 2674234369, 2674854961, 2675061841, 2677959001, 2679822289, 2680029361, 2681893369, 2682929209, 2683550809, 2685001489, 2686037929, 2686245241, 2687281921, 2688733609, 2689355881, 2690393161, 2690600641, 2692883449, 2693506201, 2694336649, 2694959569, 2696621041, 2697867481, 2698698601, 2700984841, 2701192729, 2701608529, 2703064081, 2704936081, 2706184441, 2706808729, 2709306601, 2709931249, 2710972489, 2711180761, 2712430561, 2714722609, 2716598641, 2717224129, 2719309609, 2719935409, 2720978569, 2722439329, 2722856761, 2723065489, 2723691721, 2724944401, 2727241729, 2728704169, 2729958001, 2730376009, 2731003081, 2731839289, 2734139521, 2734348681, 2735394601, 2736649969, 2737487041, 2738124199, 2741674321, 2741883769, 2742512161, 2743559641, 2744397769, 2744816881, 2749219489, 2750058481, 2751317209, 2751736849, 2755095121, 2756355001, 2757405121, 2758035289, 2759295841, 2760556681, 2760766849, 2761817809, 2762658721, 2763289489, 2763710041, 2764551241, 2764971889, 2767706881, 2769601129, 2770022161, 2770864321, 2773812889, 2774444929, 2776341481, 2776973809, 2778238681, 2778449521, 2779503841, 2780136529, 2780769289, 2782246009, 2783301049, 2784567361, 2786045089, 2788579249, 2789212969, 2789635489, 2791748569, 2794073881, 2794285321, 2796188641, 2796611689, 2797246321, 2797260929, 2798515801, 2798727409, 2800420561, 2802325969, 2803808401, 2804443849, 2805079369, 2805503089, 2806138729, 2806986361, 2808894001, 2809318009, 2810802289, 2813984209, 2814408601, 2816318761, 2817167929, 2818229569, 2818441921, 2818866649, 2819716201, 2820990769, 2821415689, 2822690641, 2824603609, 2824816201, 2826091921, 2827155241, 2827367929, 2829069721, 2829920809, 2830346401, 2833539361, 2833752289, 2834391121, 2837373289, 2837586361, 2838651841, 2838864961, 2840783401, 2841849481, 2843342329, 2843768929, 2846542609, 2847182881, 2849104129, 2849531161, 2851666801, 2852307649, 2852734921, 2853589561, 2855512969, 2855940481, 2857223209, 2860003441, 2862571009, 2862999049, 2865139729, 2867495401, 2867709601, 2869637761, 2871995281, 2872209649, 2872638409, 2873924881, 2874139321, 2874782689, 2875426129, 2876069641, 2876498689, 2877142321, 2878644409, 2879073649, 2881473967, 2881649761, 2882938249, 2883582601, 2885516089, 2885730961, 2887020361, 2890030081, 2891535529, 2891965729, 2892611089, 2893471681, 2895838969, 2896484761, 2897776561, 2899714801, 2900576449, 2901007321, 2903162161, 2903808769, 2904239881, 2904886609, 2905102201, 2905841483, 2907042889, 2907689929, 2908121329, 2909415721, 2910710401, 2911573681, 2914596169, 2915244049, 2916108001, 2917188121, 2917404169, 2918076589, 2919997369, 2921294401, 2922375481, 2924970889, 2925836281, 2926918201, 2929082641, 2930381689, 2931031321, 2932330801, 2933630569, 2934063889, 2935580761, 2936881249, 2939483089, 2942649737, 2943171001, 2945124361, 2945992729, 2947078369, 2947295521, 2947729849, 2949684721, 2950553761, 2950988329, 2951857561, 2953596409, 2955118321, 2955770689, 2956205641, 2956858129, 2959468801, 2959686409, 2960339281, 2960774569, 2961427561, 2961645241, 2963386969, 2964040249, 2964693601, 2966871961, 2969487049, 2969923009, 2970141001, 2970577009, 2972103289, 2972539441, 2974502521, 2974720681, 2975375209, 2976684481, 2977120969, 2978648929, 2979085561, 2979303889, 2979767519, 2981269201, 2983016689, 2983672129, 2984327641, 2984546161, 2986294609, 2988480889, 2989136929, 2989793041, 2993074681, 2993512369, 2994387841, 2995044529, 2997672001, 2999424289, 3000081529, 3000738841, 3001615369, 3002930401, 3006219241, 3006657889, 3008632201, 3010607161, 3011485129, 3011924161, 3014778649, 3015876889, 3016096561, 3018513481, 3019392601, 3020491681, 3022030729, 3022690441, 3023130289, 3025110001, 3025990081, 3027310441, 3029741623, 3030392401, 3030612601, 3031273249, 3031713721, 3033035329, 3033696241, 3036340609, 3037001881, 3037883689, 3038986129, 3041191609, 3042956569, 3043839241, 3047150401, 3047812849, 3048475369, 3048917089, 3049137961, 3050242441, 3051789049, 3052452001, 3053557081, 3054936851, 3057094681, 3059527969, 3061519561, 3061740889, 3062183569, 3062404921, 3062847649, 3063733201, 3066169129, 3067055161, 3067586677, 3069049201, 3070378921, 3073482721, 3073704481, 3075478849, 3076809961, 3077056399, 3078807169, 3080361001, 3081471121, 3083469841, 3084802681, 3085469209, 3089025241, 3090136921, 3091693609, 3092360881, 3093473161, 3093695641, 3094808161, 3095030689, 3095698321, 3098146921, 3098369569, 3098814889, 3099482929, 3100373761, 3101487481, 3102155809, 3103715521, 3104384089, 3104829841, 3105745579, 3106167289, 3109512169, 3112189369, 3112858849, 3113528401, 3114421249, 3115090969, 3115537489, 3115760761, 3116207329, 3116877241, 3117770569, 3118440649, 3119110801, 3121568641, 3123580321, 3124474609, 3124921801, 3125145409, 3127158241, 3127829329, 3128276761, 3128500489, 3130290601, 3132305089, 3134544169, 3135664009, 3136336009, 3137008081, 3140369521, 3140593681, 3141938809, 3145078561, 3145751569, 3146424649, 3147097801, 3147322201, 3148668769, 3149791129, 3150689161, 3152710201, 3154731889, 3155181241, 3156080041, 3158102809, 3159226849, 3159451681, 3162600169, 3162825121, 3163950001, 3165525169, 3165975289, 3166200361, 3169577401, 3170928721, 3173406889, 3176336881, 3177464161, 3178366129, 3179042689, 3180170449, 3181072801, 3182877889, 3183010111, 3184457761, 3185134969, 3185812249, 3186941209, 3188522089, 3189199729, 3189651529, 3189877441, 3191007121, 3192363001, 3192589009, 3193267081, 3194397361, 3195301729, 3195753961, 3195980089, 3197110849, 3200051761, 3202541281, 3203220409, 3203446801, 3204805321, 3206843641, 3207296689, 3210242281, 3210695569, 3211602241, 3212735761, 3213415969, 3215003401, 3216137521, 3216364369, 3218406361, 3219087169, 3220222009, 3222492289, 3223173529, 3223854841, 3224309089, 3227035249, 3227262481, 3227716969, 3228626041, 3229307929, 3231126649, 3232718449, 3234538129, 3236585881, 3236813449, 3237268609, 3238634281, 3238861921, 3240000241, 3240227929, 3240911041, 3242277481, 3243416401, 3244099849, 3244783369, 3247062289, 3247746121, 3248202049, 3248367641, 3248886001, 3253219369, 3253675681, 3254360209, 3255729481, 3257327329, 3257783929, 3259153921, 3260067409, 3261209449, 3261545587, 3262580161, 3262808641, 3263951161, 3264865321, 3265322449, 3266008201, 3267608569, 3268751929, 3269438041, 3270810481, 3271039249, 3272183209, 3274242841, 3274471729, 3276532081, 3277677001, 3278593081, 3279738361, 3279967441, 3281342089, 3281800369, 3283404601, 3286614241, 3286843561, 3288008303, 3288678409, 3288907801, 3290972689, 3291661129, 3292808689, 3293497321, 3294415609, 3296252569, 3297860329, 3301293169, 3301306849, 3302456089, 3304755169, 3305445049, 3306595009, 3309355729, 3309585841, 3312808249, 3313038481, 3314420041, 3316262569, 3316953649, 3317875201, 3322023769, 3322484881, 3323407201, 3323868409, 3325482889, 3326867041, 3327970157, 3328020721, 3328943809, 3330328681, 3330790369, 3331482961, 3332406529, 3332868361, 3333561169, 3335178001, 3337719529, 3338643961, 3339337369, 3339799681, 3340030849, 3341186809, 3341880481, 3344193241, 3345349921, 3346275409, 3346969609, 3347663881, 3350210161, 3352294201, 3352525801, 3354378889, 3355073929, 3357391249, 3357854809, 3360868729, 3361332529, 3362956081, 3365508169, 3367132729, 3367596961, 3368254499, 3368989849, 3369686401, 3370615249, 3371079721, 3371776489, 3372473329, 3373402561, 3375493801, 3376655881, 3376888321, 3378980641, 3381073609, 3381538801, 3381771409, 3383632561, 3383865241, 3385959721, 3386425249, 3387123601, 3388054849, 3388520521, 3389219089, 3390616441, 3390849361, 3391548169, 3392247049, 3395509441, 3399939481, 3400405969, 3401339041, 3403205569, 3404825447, 3406239769, 3406706689, 3406940161, 3408107641, 3409508881, 3409742449, 3410910409, 3411844921, 3412545889, 3413714329, 3415116721, 3415350481, 3416519401, 3416753209, 3419559529, 3420027361, 3423537121, 3426580369, 3427282849, 3427985401, 3430093489, 3430796329, 3431499241, 3434077201, 3434311609, 3435483769, 3437594161, 3440643649, 3441112921, 3443225041, 3444163969, 3444868249, 3445572601, 3446981521, 3448860529, 3449565289, 3449795831, 3450505081, 3452385049, 3453090169, 3454030441, 3455911369, 3456146521, 3461086561, 3467914321, 3468856609, 3469327801, 3470034649, 3470270281, 3470741569, 3471684241, 3473569969, 3474277249, 3476635369, 3477107089, 3478522441, 3479938081, 3480646009, 3482062081, 3482298121, 3483478441, 3483714529, 3484422841, 3486784401, 3487020601, 3487256809, 3488437969, 3489146761, 3490091929, 3490800889, 3491982649, 3493637449, 3494346769, 3495056161, 3495529129, 3497657881, 3498604201, 3499787281, 3500733889, 3502627489, 3504284809, 3505468849, 3505705681, 3506889961, 3507126841, 3508548289, 3509259121, 3509733049, 3512103169, 3513288529, 3514236961, 3520404889, 3521354281, 3522541201, 3523253449, 3523490881, 3524678161, 3525628129, 3526815769, 3527528449, 3528241201, 3529191649, 3530379889, 3530617561, 3532642667, 3533232481, 3533470249, 3533945809, 3534659209, 3536324089, 3536799841, 3537037729, 3539893009, 3541321081, 3541797169, 3544892521, 3547036249, 3547512721, 3548227489, 3549895561, 3553471321, 3554186689, 3554663641, 3555379129, 3555617641, 3558241801, 3559196281, 3559673569, 3560389561, 3560628241, 3563254249, 3563970601, 3564925849, 3566836729, 3567553441, 3569226049, 3569704009, 3570421009, 3572572441, 3573528841, 3574963681, 3575681209, 3577116481, 3579987889, 3583578769, 3585494641, 3586452769, 3588604291, 3590526241, 3591485041, 3594122401, 3594841849, 3596520841, 3597720361, 3599880001, 3601560169, 3602040289, 3603480841, 3604441369, 3604921681, 3609245929, 3609966889, 3610687921, 3610928281, 3612130201, 3612370609, 3612851449, 3615256129, 3615977689, 3616699321, 3617902201, 3619345921, 3620067889, 3620308561, 3625123681, 3626087089, 3626809729, 3630183001, 3630906049, 3631147081, 3632593441, 3634763521, 3635245849, 3638140489, 3639829561, 3640553569, 3641277649, 3642484609, 3644899129, 3646106689, 3647797609, 3649730569, 3651422329, 3653356249, 3654081601, 3655048849, 3659403049, 3659887009, 3661339081, 3662791441, 3663517729, 3664970521, 3671026921, 3672481201, 3673208449, 3673650007, 3673693321, 3674420689, 3675148129, 3676118161, 3676845769, 3678058609, 3678301201, 3679514281, 3679756921, 3681941041, 3683154721, 3684854209, 3686796961, 3687768529, 3688497289, 3688983169, 3691413049, 3691899121, 3692142169, 3693357529, 3694086841, 3695788849, 3697977721, 3699194041, 3703817881, 3705035161, 3707226769, 3707470321, 3708688201, 3708931801, 3710393569, 3710880889, 3711124561, 3711611929, 3713317969, 3714049249, 3715268209, 3716243521, 3716672149, 3721122001, 3721854049, 3724294729, 3724782961, 3726247849, 3727224601, 3727957249, 3732110281, 3733087801, 3735776641, 3736754641, 3738221881, 3739444801, 3739689409, 3741646561, 3745539377, 3746786521, 3748255729, 3749235361, 3751930009, 3752910121, 3755606089, 3756586681, 3757322209, 3761491561, 3761736889, 3762472921, 3762963649, 3764681449, 3765417769, 3767381641, 3767627161, 3770328409, 3771065281, 3772047889, 3774996481, 3777700369, 3778437961, 3778683841, 3780159289, 3780651169, 3781389049, 3783111049, 3783603121, 3784587361, 3787540849, 3788033209, 3788771809, 3789119879, 3789510481, 3789756721, 3792465889, 3794929609, 3795668881, 3796161769, 3797887129, 3798380161, 3799119769, 3799859449, 3800845801, 3801585649, 3802818889, 3803558929, 3804545761, 3805285969, 3807260209, 3808988089, 3809728729, 3810469441, 3813186001, 3813927049, 3816891961, 3820846969, 3821588761, 3823814569, 3824556649, 3826783321, 3828020641, 3829010641, 3832724281, 3834953329, 3835696489, 3837678601, 3839165521, 3839909089, 3841396441, 3841644361, 3842388169, 3842884081, 3844372009, 3845364121, 3846108289, 3847751263, 3848837521, 3849830209, 3850574809, 3851071249, 3852809041, 3854050561, 3856285801, 3858770161, 3860012641, 3860261161, 3861006769, 3861503881, 3861752449, 3865233241, 3867471721, 3867720481, 3868964401, 3869710849, 3870457369, 3871203961, 3872946289, 3877292411, 3877926529, 3880916209, 3881165401, 3881663809, 3882660721, 3884156329, 3884654929, 3887148409, 3887647201, 3891638689, 3893884801, 3895881889, 3896630929, 3901126681, 3902126089, 3902875729, 3903375529, 3904125289, 3905875009, 3906375001, 3907125049, 3910376089, 3911126521, 3912377401, 3914128969, 3916381561, 3917633281, 3918384409, 3919135609, 3920888689, 3922141129, 3922892689, 3923644321, 3925398409, 3926150281, 3929158489, 3929659969, 3931415401, 3934174729, 3935178361, 3936684049, 3936827539, 3937939009, 3938943121, 3939040643, 3940449529, 3942709681, 3943965601, 3946226761, 3947231929, 3950248201, 3951505321, 3952511161, 3953014129, 3956032609, 3956787409, 3959052241, 3959807329, 3960059041, 3961317721, 3965094961, 3965346841, 3966606361, 3966822287, 3966858289, 3967362169, 3967614121, 3969126001, 3972654841, 3972906961, 3976437481, 3977446489, 3978203329, 3978960241, 3981231409, 3981988609, 3983250769, 3985018129, 3985523161, 3987796201, 3991586041, 3993860809, 3994113601, 3995630521, 3999424081, 4000183009, 4003978729, 4004484961, 4006763401, 4008282721, 4008535969, 4009042489, 4010815561, 4011575569, 4012842409, 4013602609, 4014616321, 4015376689, 4016644129, 4018165321, 4018418881, 4019179609, 4020701281, 4021969561, 4022223241, 4024506721, 4025014249, 4027552369, 4028060089, 4028821729, 4030599169, 4031361049, 4032123001, 4034917441, 4035679729, 4036442089, 4037458681, 4039746481, 4042034929, 4043306569, 4043560921, 4044832801, 4045087201, 4045850449, 4046359321, 4047122689, 4048649641, 4050940609, 4051195201, 4052468281, 4053486889, 4053996241, 4056288721, 4056543481, 4057307809, 4058072209, 4058836681, 4060110961, 4061130529, 4062405169, 4063170049, 4065465121, 4066995529, 4068015961, 4069546849, 4070312401, 4070822809, 4071588481, 4073003173, 4073375329, 4075417921, 4075673281, 4077205609, 4077716449, 4078482769, 4083337801, 4084104649, 4084871569, 4086917041, 4089474601, 4093056529, 4095616009, 4096896049, 4097664169, 4098432361, 4100225089, 4100737369, 4103684801, 4104067969, 4104580489, 4106374561, 4107656281, 4109963881, 4111759129, 4115350801, 4115607409, 4116120649, 4117917241, 4119970969, 4120227721, 4123823089, 4124593729, 4125621361, 4126392169, 4130761441, 4131789841, 4132304089, 4134618601, 4134875809, 4136933761, 4137962929, 4138734889, 4143883129, 4144913161, 4147231201, 4147746409, 4149995543, 4151611489, 4152384721, 4153931401, 4154189209, 4158057289, 4158831121, 4160121001, 4161927169, 4165509529, 4167089809, 4168897489, 4170188929, 4170447241, 4171997281, 4173289201, 4174322881, 4174839769, 4175873641, 4176649129, 4177424689, 4181044921, 4181303569, 4181820889, 4183373041, 4185184249, 4187254681, 4188290089, 4192174009, 4194246169, 4196577961, 4196653397, 4196837089, 4198132849, 4200465721, 4201243489, 4205392801, 4205911609, 4208246641, 4209025129, 4209284641, 4210841881, 4212139801, 4214476561, 4214736241, 4215515329, 4216813969, 4218632401, 4220970961, 4224610009, 4225390009, 4226430121, 4228510729, 4228770841, 4229291089, 4231892809, 4233193969, 4234235041, 4236577921, 4237879801, 4238140201, 4239442321, 4240484161, 4241005129, 4241786641, 4243349881, 4243659659, 4244131609, 4246737889, 4247259241, 4247519929, 4248302041, 4248823489, 4251431209, 4252735369, 4256127121, 4258476049, 4259406061, 4259781289, 4260042361, 4262392369, 4263175849, 4265265481, 4267094329, 4267616929, 4271014609, 4271537449, 4273367641, 4274675161, 4276244449, 4278075649, 4278860569, 4279645561, 4280168929, 4282000969, 4283309809, 4283571601, 4287499441, 4289857009, 4292739361, 4293001441, 4294967295};

void 
fb_fprint_entry (FILE *fd, const factorbase_degn_t *fb)
{
  int i;
  fprintf (fd, "Prime " FBPRIME_FORMAT " with rounded log %d and roots ", 
	   fb->p, (int) fb->plog);
  for (i = 0; i < fb->nr_roots; i++)
    {
      fprintf (fd, FBROOT_FORMAT, fb->roots[i]);
      if (i + 1 < fb->nr_roots)
	fprintf (fd, ", ");
    }
  fprintf (fd, "\n");
}

void 
fb_fprint (FILE *fd, const factorbase_degn_t *fb)
{
  while (fb->p != FB_END)
    {
      fb_fprint_entry (fd, fb);
      fb = fb_next (fb);
    }
}

/* Add fb_add to (void *)fb + fbsize. If a realloc failed, returns NULL.
   fb_add->size need not be set by caller, this function does it */

static factorbase_degn_t *
fb_add_to (factorbase_degn_t *fb, size_t *fbsize, size_t *fballoc,
	   const size_t allocblocksize, factorbase_degn_t *fb_add)
{
  const size_t fb_addsize  = fb_entrysize (fb_add); 
  factorbase_degn_t *newfb = fb;

  ASSERT(fb_addsize <= allocblocksize); /* Otherwise we still might not have
					   enough mem after the realloc */

  /* Do we need more memory for fb? */
  if (*fballoc < *fbsize + fb_addsize)
    {
      *fballoc += allocblocksize;
      newfb = (factorbase_degn_t *) realloc (fb, *fballoc);
      if (newfb == NULL)
	{
	  fprintf (stderr, 
		   "Could not reallocate factor base to %lu bytes\n",
		   (unsigned long) *fballoc);
	  return NULL;
	}
    }
  memcpy (fb_skip(newfb, *fbsize), fb_add, fb_addsize);
  fb_skip(newfb, *fbsize)->size = fb_addsize;
  
  *fbsize += fb_addsize;

  return newfb;
}

/* Sort n primes in array *primes into ascending order */

void
fb_sortprimes (fbprime_t *primes, const unsigned int n)
{
  unsigned int k, l, m;
  fbprime_t t;

  for (l = n; l > 1; l = m)
    for (k = m = 0; k < l - 1; k++)
      if (primes[k] > primes[k + 1])
	{
	  t = primes[k];
	  primes[k] = primes[k + 1];
	  primes[k + 1] = t;
	  m = k + 1;
	}
#ifndef NDEBUG
  for (k = 1; k < n; k++)
    ASSERT(primes[k - 1] <= primes[k]);
#endif
}

#if 0
static double
fb_log_double (double n, double log_scale, double offset)
{
  return floor (log (n) * log_scale + offset + 0.5);
}
#endif

unsigned char
fb_log (double n, double log_scale, double offset)
{
  return (unsigned char) floor (log (n) * log_scale + offset + 0.5);
}

/* Assuming q is a prime or a prime power, let k be the largest integer with
   q = p^k, return p if k > 1, 0 otherwise */
static uint32_t
is_prime_power (uint32_t q)
{
  unsigned int maxk, k;
  uint32_t p;

  for (maxk = 0, p = q; p > 1; p /= 2, maxk ++);
  for (k = maxk; k >= 2; k--)
    {
      p = (uint32_t) (pow ((double) q, 1.0 / (double) k) + 0.5);
      if (q % p == 0)
        return p;
    }
  return 0;
}

/* same as is_prime_power, but faster */
static uint32_t
is_prime_power_fast (uint32_t q)
{
  int a = 0, b = 6948, c;

  /* invariant: prime_powers[a] <= q < prime_powers[b] */
  while (a + 1 < b)
    {
      c = (a + b) / 2;
      if (q < prime_powers[c])
        b = c;
      else
        a = c;
    }
  /* now a+1 = b */
  if (q == prime_powers[a])
    return is_prime_power (q);
  else
    return 0;
}

/* Make one factor base entry for a linear polynomial poly[1] * x + poly[0]
   and the prime (power) q. We assume that poly[0] and poly[1] are coprime.
   Non-projective roots a/b such that poly[1] * a + poly[0] * b == 0 (mod q) 
   with gcd(poly[1], q) = 1 are stored as a/b mod q.
   If do_projective != 0, also stores projective roots with gcd(q, f_1) > 1, 
   but stores the reciprocal root plus p, p + b/a mod p^k.
   If no root was stored (projective root with do_projective = 0) returns 0, 
   returns 1 otherwise. */

static int
fb_make_linear1 (factorbase_degn_t *fb_entry, const mpz_t *poly,
		 const fbprime_t p, const unsigned char logp, 
		 const int do_projective)
{
  modulusul_t m;
  residueul_t r0, r1;
  modintul_t gcd;
  int is_projective, rc;
  
  fb_entry->p = p;
  fb_entry->plog = logp;
  
  modul_initmod_ul (m, p);
  modul_init_noset0 (r0, m);
  modul_init_noset0 (r1, m);
  
  modul_set_ul_reduced (r0, mpz_fdiv_ui (poly[0], p), m);
  modul_set_ul_reduced (r1, mpz_fdiv_ui (poly[1], p), m);
  modul_gcd (gcd, r1, m);
  is_projective = (modul_intcmp_ul (gcd, 1UL) > 0);
  
  if (is_projective)
    {
      if (!do_projective)
	{
	  modul_clear (r0, m);
	  modul_clear (r1, m);
	  modul_clearmod (m);
	  return 0; /* If we don't do projective roots, just return */
	}
      modul_swap (r0, r1, m);
    }
  
  /* We want poly[1] * a + poly[0] * b == 0 <=> 
     a/b == - poly[0] / poly[1] */
  rc = modul_inv (r1, r1, m); /* r1 = 1 / poly[1] */
  ASSERT_ALWAYS (rc != 0);
  modul_mul (r1, r0, r1, m); /* r1 = poly[0] / poly[1] */
  modul_neg (r1, r1, m); /* r1 = - poly[0] / poly[1] */
  
  fb_entry->roots[0] = modul_get_ul (r1, m) + (is_projective ? p : 0);
  if (p % 2 != 0)
    fb_entry->invp = - modul_invmodlong (modul_getmod_ul (m));
  
  modul_clear (r0, m);
  modul_clear (r1, m);
  modul_clearmod (m);
  
  return 1;
}


/* Generate a factor base with primes <= bound and prime powers <= powbound 
   for a linear polynomial. If projective != 0, adds projective roots 
   (for primes that divide leading coefficient) */

factorbase_degn_t *
fb_make_linear (const mpz_t *poly, const fbprime_t bound, 
		const fbprime_t powbound, const double log_scale, 
		const int verbose, const int projective, FILE *output)
{
  fbprime_t p;
  factorbase_degn_t *fb = NULL, *fb_cur, *fb_new;
  size_t fbsize = 0, fballoc = 0, pow_len = 0;
  const size_t allocblocksize = 1 << 20;
  unsigned long logp;
  int had_proj_root = 0;
  fbprime_t *powers = NULL, min_pow = 0; /* List of prime powers that yet 
					    need to be included, and the 
					    minimum among them */

  rdtscll (tsc1);
  fb_cur = (factorbase_degn_t *) malloc (fb_entrysize_uc (1));
  ASSERT (fb_cur != NULL);

  fb_cur->nr_roots = 1;
  fb_cur->size = fb_entrysize_uc (1);

  if (verbose)
    gmp_fprintf (output, 
		 "# Making factor base for polynomial g(x) = %Zd * x + %Zd,\n"
		 "# including primes up to " FBPRIME_FORMAT 
		 " and prime powers up to " FBPRIME_FORMAT ".\n",
		 poly[1], poly[0], bound, powbound);
  
  p = 2;
  while (p <= bound)
    {
      fbprime_t q;
      /* Handle any prime powers that are smaller than p */
      if (pow_len > 0 && min_pow < p)
	{
	  size_t i;
	  /* Find this p^k in the list of prime powers and replace it 
	     by p^(k+1) if p^(k+1) does not exceed powbound, otherwise
	     remove p^k from the list */
	  for (i = 0; i < pow_len && powers[i] != min_pow; i++);
	  ASSERT_ALWAYS (i < pow_len);
	  q = is_prime_power (min_pow);
	  ASSERT (min_pow / q >= q && min_pow % (q*q) == 0);
	  logp = fb_log (min_pow, log_scale, 0.) - 
	         fb_log (min_pow / q, log_scale, 0.);
	  if (powers[i] <= powbound / q)
	    powers[i] *= q; /* Increase exponent */
	  else
	    {
	      for ( ; i < pow_len - 1; i++) /* Remove from list */
		powers[i] = powers[i + 1];
	      pow_len--;
	    }
	  q = min_pow;
	  /* Find new minimum among the prime powers */
	  if (pow_len > 0)
	    min_pow = powers[0];
	  for (i = 1; i < pow_len; i++)
	    if (powers[i] < min_pow)
	      min_pow =  powers[i];
	}
      else
	{
	  q = p;
	  logp = fb_log (q, log_scale, 0.);
	  /* Do we need to add this prime to the prime powers list? */
	  if (q <= powbound / q)
	    {
	      size_t i;
	      powers = realloc (powers, (++pow_len) * sizeof (fbprime_t));
	      ASSERT_ALWAYS(powers != NULL);
	      powers[pow_len - 1] = q*q;
	      /* Find new minimum among the prime powers */
	      min_pow = powers[0];
	      for (i = 1; i < pow_len; i++)
		if (powers[i] < min_pow)
		  min_pow =  powers[i];
	    }
	  p = getprime (p);
	}
      
      if (!fb_make_linear1 (fb_cur, poly, q, logp, projective))
	continue; /* If root is projective and we don't want those, 
		     skip to next prime */
      
      if (verbose && fb_cur->p > q)
	{
	  if (!had_proj_root)
	    {
	      fprintf (output, "# Primes with projective roots:");
	      had_proj_root = 1;
	    }
	  fprintf (output, " " FBPRIME_FORMAT , q);
	}
      
      fb_new = fb_add_to (fb, &fbsize, &fballoc, allocblocksize, fb_cur);
      if (fb_new == NULL)
	{
	  free (fb);
	  fb = NULL;
	  break;
	}
      /* fb_fprint_entry (stdout, fb_cur); */
      fb = fb_new;
      
      /* FIXME: handle prime powers */
    }

  getprime (0); /* free prime iterator */

  if (fb != NULL) /* If nothing went wrong so far, put the end-of-fb mark */
    {
      fb_cur->p = FB_END;
      fb_cur->invp = -1L;
      fb_cur->nr_roots = 0;
      fb_new = fb_add_to (fb, &fbsize, &fballoc, allocblocksize, fb_cur);
      if (fb_new == NULL)
	free (fb);
      fb = fb_new;
    }

  free (fb_cur);
  free (powers);

  if (had_proj_root)
    fprintf (output, "\n");

  rdtscll (tsc2);

  return fb;
}

#if 0
static int fb_comp(const void *a, const void *b) {
  factorbase_degn_t *pa, *pb;
  pa = (factorbase_degn_t *)a;
  pb = (factorbase_degn_t *)b;
  if (pa->p < pb->p) 
    return -1;
  if (pa->p > pb->p) 
    return 1;
  return 0;
}
#endif

#if 0
/* Generate a factor base with prime powers <= bound for a linear polynomial */
static factorbase_degn_t *
fb_make_linear_powers (mpz_t *poly, const fbprime_t bound, const double log_scale, 
		const int verbose)
{
  fbprime_t p;
  factorbase_degn_t *fb = NULL, *fb_cur, *fb_new;
  size_t fbsize = 0, fballoc = 0;
  const size_t allocblocksize = 1 << 20;
  
  rdtscll (tsc1);
  fb_cur = (factorbase_degn_t *) malloc (fb_entrysize_uc (1));
  ASSERT (fb_cur != NULL);

  fb_cur->nr_roots = 1;
  fb_cur->size = fb_entrysize_uc (1);

  if (verbose)
    {
      printf ("# Making factor base for polynomial g(x) = ");
      printf ("\n");
    }

  for (p = 2 ; p <= bound; p = getprime (p))
    {
      modulusul_t m;
      residueul_t r1, r2;
      uint64_t llq;
      fbprime_t q;
      unsigned char old_logpk;

      llq = (uint64_t)p;
      old_logpk = 0;
      while (llq <= (uint64_t)bound) {
	q = (fbprime_t)llq;
	if (q > p)
	  break;

	fb_cur->p = q;
	// TODO: adjust that!
	if (old_logpk == 0) {
	  old_logpk = fb_log (fb_cur->p, log_scale, 0.);
	  fb_cur->plog = old_logpk;
	} else {
	  double newlog;
	  newlog = fb_log_double (fb_cur->p, log_scale, 0.) - (double)old_logpk;
	  old_logpk = (unsigned char) newlog;
	  fb_cur->plog = old_logpk;
	}

	modul_initmod_ul (m, q);
	modul_init_noset0 (r1, m);
	modul_init_noset0 (r2, m);

	/* We want f_1 * a + f_0 * b == 0 (mod p^k) 
	   with a, b coprime and f_1, f_0 coprime

	   p^m = gcd (f_1, p^k)

	   p^k | F(a,b) <=>
	   ( f_0 * b == 0 (mod p^m) <=> b == 0 (mod p^m)  && 
	   (f_1/p^m) * a + f_0 * (b/p^m) == 0 (mod p^(k-m)) )

	   p^m = (p^k, f_1) => 
	   p^k | F(a,b) <=> p^m | b && f(a/b) == 0 (mod p^(k-m))

*/

	modul_set_ul_reduced (r2, mpz_fdiv_ui (poly[1], q), m);
	/* If p | g1 and !(p | g0), p|G(a,b) <=> p|b and that will be handeled
	   by the projective roots */
	if (modul_get_ul (r2, m) == 0)
	  continue;
	modul_set_ul_reduced (r1, mpz_fdiv_ui (poly[0], q), m);

	/* We want g_1 * a + g_0 * b == 0 <=> a/b == - g0 / g1 */
	if (!modul_inv (r2, r2, m)) /* r2 = 1 / g1 */
	  continue;

	modul_mul (r2, r1, r2, m); /* r2 = g0 / g1 */
	modul_neg (r2, r2, m); /* r2 = - g0 / g1 */

#ifndef NDEBUG
	{
	  residueul_t r3;
	  modul_init_noset0 (r3, m);
	  modul_set_ul_reduced (r3, mpz_fdiv_ui (poly[1], q), m);
	  modul_mul (r3, r3, r2, m); /* g1 * (- g0 / g1) */
	  modul_add (r3, r3, r1, m); /* g1 * (- g0 / g1) + g0 */
	  ASSERT (modul_get_ul (r3, m) == 0);
	  modul_clear (r3, m);
	}
#endif

	if (p % 2 != 0)
	  fb_cur->invp = - modul_invmodlong (m);
	fb_cur->roots[0] = modul_get_ul (r2, m);

	modul_clear (r1, m);
	modul_clear (r2, m);
	modul_clearmod (m);

	fb_new = fb_add_to (fb, &fbsize, &fballoc, allocblocksize, fb_cur);
	if (fb_new == NULL)
	{
	  free (fb);
	  fb = NULL;
	  break;
	}
	/* fb_fprint_entry (stdout, fb_cur); */
	fb = fb_new;

	/* get next power of p */
	llq *= (uint64_t)p;
      }
    }
  getprime (0); /* free prime iterator */

  /* Sort the factor base */
  qsort((void *)fb, fbsize / fb_entrysize_uc(1), fb_entrysize_uc(1), fb_comp);


  if (fb != NULL) /* If nothing went wrong so far, put the end-of-fb mark */
    {
      fb_cur->p = FB_END;
      fb_cur->invp = -1L;
      fb_cur->nr_roots = 0;
      fb_new = fb_add_to (fb, &fbsize, &fballoc, allocblocksize, fb_cur);
      if (fb_new == NULL)
	free (fb);
      fb = fb_new;
    }

  free (fb_cur);

  rdtscll (tsc2);

  return fb;
}
#endif

factorbase_degn_t *
fb_read_addproj (const char *filename, const double log_scale, 
                 const int verbose, const fbprime_t *proj_primes)
{
  factorbase_degn_t *fb = NULL, *fb_cur, *fb_new;
  FILE *fbfile;
  size_t fbsize = 0, fballoc = 0;
  // too small linesize led to a problem with rsa768;
  // it would probably be a good idea to get rid of fgets
  const size_t linesize = 1000;
  size_t linelen;
  char line[linesize];
  char *lineptr;
  int ok;
  unsigned int i;
  unsigned long linenr = 0;
  const size_t allocblocksize = 1<<20; /* Allocate in MB chunks */
  fbprime_t p, q; /* q is factor base entry q = p^k */
  fbprime_t maxprime = 0;
  unsigned long nr_primes = 0;

  fbfile = fopen (filename, "r");
  if (fbfile == NULL)
    {
      fprintf (stderr, "# Could not open file %s for reading\n", filename);
      return NULL;
    }

  fb_cur = (factorbase_degn_t *) malloc (sizeof (factorbase_degn_t) + 
				      MAXDEGREE * sizeof(fbroot_t));
  if (fb_cur == NULL)
    {
      fprintf (stderr, "# Could not allocate memory for factor base\n");
      fclose (fbfile);
      return NULL;
    }

  while (!feof(fbfile))
    {
      if (fgets (line, linesize, fbfile) == NULL)
	break;
      linenr++;
      linelen = strlen (line);
      if (linelen > 0 && line[linelen - 1] == '\n')
	linelen--; /* Remove newline */
      for (i = 0; i < linelen; i++) /* Skip comments */
        if (line[i] == '#')
          linelen = i;
      while (linelen > 0 && isspace((int)(unsigned char)line[linelen - 1]))
        linelen--; /* Skip whitespace at end of line */
      if (linelen == 0) /* Skip empty/comment lines */
	continue;
      line[linelen] = '\0';

      /* Parse the line */
      lineptr = line;
      q = strtoul (lineptr, &lineptr, 10);
      ok = 0;
      if (q == 0)
	fprintf (stderr, "# fb_read: prime is not an integer on line %lu\n", 
		 linenr);
      else if (*lineptr != ':')
	fprintf (stderr, "# fb_read: prime is not followed by colon on line %lu",
		 linenr);
      else
	ok = 1;
      if (!ok)
	exit (EXIT_FAILURE);

      if (q <= maxprime)
	{
	  fprintf (stderr, "# Error, primes in factor base file are "
		   "not in increasing order\n");
	  free (fb);
	  fb = NULL;
	  break;
	}

      /* we assume q is a prime or a prime power */
      p = is_prime_power_fast (q);
      if (p != 0)
        {
          fbprime_t cof = q;
          while (cof % p == 0)
            cof /= p;
          if (cof != 1)
            {
              fprintf (stderr, "# Error, " FBPRIME_FORMAT " on line %lu in "
                       "factor base is not a prime or prime power\n",
                       q, linenr);
              break;                       
            }
        }
      else
	p = q; /* If q is prime, p = q */

      /* We have a valid prime or prime power for q. 
         Maybe there's one (or several) prime with only a projective root 
	 smaller than q that we need to add to the factor base first. */
      while (proj_primes != NULL && *proj_primes != 0 && *proj_primes < q)
        {
          fb_cur->p = *proj_primes++;
          fb_cur->plog = fb_log (fb_cur->p, log_scale, 0.);
          fb_cur->nr_roots = 1;
          fb_cur->roots[0] = fb_cur->p;
	  /* Compute invp */
	  if (fb_cur->p % 2 != 0)
	    {
	      modulusul_t m;
	      
	      modul_initmod_ul (m, fb_cur->p);
	      fb_cur->invp = - modul_invmodlong (modul_getmod_ul (m));
	      modul_clearmod (m);
	    }
	  
          fb_new = fb_add_to (fb, &fbsize, &fballoc, allocblocksize, fb_cur);
          if (fb_new == NULL)
            {
              free (fb);
              fb = NULL;
              break;
            }
          /* fb_fprint_entry (stdout, fb_cur); */
          fb = fb_new;
          maxprime = fb_cur->p;
          nr_primes++;
        }

      fb_cur->p = q;
      if (p == 0) /* It's a prime, do a normal log */
	fb_cur->plog = fb_log (fb_cur->p, log_scale, 0.);
      else
	{
	  /* Take into account the logs of the smaller powers of p that
	     have been added already. We should not just use 
	     fb_cur->plog = log(p) as that would allow rounding errors to 
	     accumulate. */
	  double oldlog;
	  oldlog = fb_log (fb_cur->p / p, log_scale, 0.);
	  fb_cur->plog = fb_log (fb_cur->p, log_scale, - oldlog);
	}

      lineptr++; /* Skip colon */
      ok = 1;
      fb_cur->nr_roots = 0;
      /* Read roots */
      while (ok && *lineptr != '\0')
	{
	  if (fb_cur->nr_roots == MAXDEGREE)
            {
              fprintf (stderr, "# Error, too many roots for prime " FBPRIME_FORMAT 
                      " in factor base line %lu\n", fb_cur->p, linenr);
              ok = 0;
              break;
            }
	  fbroot_t root = strtoul (lineptr, &lineptr, 10);
	  fb_cur->roots[fb_cur->nr_roots++] = root;
	  /* Check if root is properly reduced. Projective roots s/t (mod p^k)
	     with p|t are stored as p + (t/s mod p^k). */
	  if (root >= 2 * fb_cur->p || (root >= fb_cur->p && root % p != 0))
	    ok = 0;
	  if (*lineptr != '\0' && *lineptr != ',')
	    ok = 0;
	  if (*lineptr == ',')
	    lineptr++;
	}
      
      if (fb_cur->nr_roots == 0)
        {
          fprintf (stderr, "# Error, no root for prime " FBPRIME_FORMAT
                   " in factor base line %lu\n", fb_cur->p, linenr - 1);
          ok = 0;
        }

      if (ok && proj_primes != NULL && fb_cur->p == proj_primes[0])
        {
          int i;
          /* Was the projective root already given in the factor base file? */
          for (i = 0; i < fb_cur->nr_roots; i++)
            if (fb_cur->roots[i] == fb_cur->p)
              break;
          if (i == fb_cur->nr_roots) /* No, need to add it */
            {
              if (fb_cur->nr_roots == MAXDEGREE)
                fprintf (stderr, "# Error, can't add projective root for " 
                         FBPRIME_FORMAT ", already has %d roots\n", 
                        fb_cur->p, fb_cur->nr_roots);
              else
                fb_cur->roots[fb_cur->nr_roots++] = fb_cur->p;
            }
          proj_primes++;
        }

      if (!ok)
	{
	  fprintf (stderr, "# Incorrect format in factor base file line %lu\n",
		   linenr - 1);
	  exit (EXIT_FAILURE);
	}

      /* Sort the roots into ascending order. We assume that fbprime_t and 
         fbroot_t are typecast compatible. This is ugly. */
      ASSERT_ALWAYS (sizeof (fbprime_t) == sizeof (fbroot_t));
      fb_sortprimes ((fbprime_t *) fb_cur->roots, fb_cur->nr_roots);
      /* Eliminate duplicate roots. Pari's polrootsmod() can produce them */
      {
        unsigned int i = 0, j;
        for (j = 1; j < (unsigned int) fb_cur->nr_roots; j++)
          {
            if (fb_cur->roots[i] == fb_cur->roots[j])
              {
                fprintf (stderr, "Warning, factor base has repeated root " 
                         FBROOT_FORMAT " for prime " FBPRIME_FORMAT ". "
                         "Keeping only one.\n", fb_cur->roots[i], fb_cur->p);
              }
            else
              fb_cur->roots[++i] = fb_cur->roots[j];
          }
          fb_cur->nr_roots = i + 1;
      }
      
      /* Compute invp */
      if (fb_cur->p % 2 != 0)
	{
	  modulusul_t m;
	  
	  modul_initmod_ul (m, fb_cur->p);
	  fb_cur->invp = - modul_invmodlong (modul_getmod_ul (m));
	  modul_clearmod (m);
	}

      fb_new = fb_add_to (fb, &fbsize, &fballoc, allocblocksize, fb_cur);
      if (fb_new == NULL)
	{
	  free (fb);
	  fb = NULL;
	  break;
	}
      /* fb_fprint_entry (stdout, fb_cur); */
      fb = fb_new;
      maxprime = fb_cur->p;
      nr_primes++;
    }      

  if (fb != NULL) /* If nothing went wrong so far, put the end-of-fb mark */
    {
      fb_cur->p = FB_END;
      fb_cur->invp = -1L;
      fb_cur->nr_roots = 0;
      fb_new = fb_add_to (fb, &fbsize, &fballoc, allocblocksize, fb_cur);
      if (fb_new == NULL)
	free (fb);
      fb = fb_new;
    }

  if (fb != NULL && verbose)
    {
      printf ("# Factor base sucessfully read, %lu primes, largest was "
	      FBPRIME_FORMAT "\n", nr_primes, maxprime);
    }
  
  fclose (fbfile);
  free (fb_cur);
  return fb;
}

/* return the total size (in bytes) used by fb */
size_t
fb_size (const factorbase_degn_t *fb)
{
  size_t mem = 0;
  while (fb->p != FB_END)
    {
      mem += sizeof (fbprime_t) + sizeof (unsigned long)
        + 4 * sizeof (unsigned char)
        + sizeof (fbroot_t) * fb->nr_roots;
      fb = fb_next (fb);
    }
  return mem;
}

/* return the total size (in number of roots) for this fb */
size_t
fb_nroots_total (const factorbase_degn_t *fb)
{
  size_t n = 0;
  for( ; fb->p != FB_END ; fb = fb_next (fb))
      n += fb->nr_roots;
  return n;
}


factorbase_degn_t *
fb_read (const char *filename, const double log_scale, const int verbose)
{
  return fb_read_addproj (filename, log_scale, verbose, NULL);
}

/* For all primes p that divide b, disable p and powers of p in fb */
/* Extracts primes (not prime powers) p <= plim with 
   p/nr_roots <= costlim. List ends with FB_END. Allocates memory */
fbprime_t *
fb_extract_bycost (const factorbase_degn_t *fb, const fbprime_t plim, 
                   const fbprime_t costlim)
{
  const factorbase_degn_t *fb_ptr;
  fbprime_t *primes;
  int i;
  
  fb_ptr = fb;
  i = 0;
  while (fb_ptr->p != FB_END && fb_ptr->p <= plim)  
    {
      if (fb_ptr->p <= costlim * fb_ptr->nr_roots &&
	  !is_prime_power(fb_ptr->p))
        i++;
      fb_ptr = fb_next (fb_ptr);
    }

  primes = (fbprime_t *) malloc ((i + 1) * sizeof (fbprime_t));
  ASSERT (primes != NULL);

  fb_ptr = fb;
  i = 0;
  while (fb_ptr->p != FB_END && fb_ptr->p <= plim)  
    {
      if (fb_ptr->p <= costlim * fb_ptr->nr_roots &&
	  !is_prime_power(fb_ptr->p))
        primes[i++] = fb_ptr->p;
      fb_ptr = fb_next (fb_ptr);
    }

  primes[i] = FB_END;
  
  return primes;
}
